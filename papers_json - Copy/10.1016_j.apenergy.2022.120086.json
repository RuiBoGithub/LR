{"full-text-retrieval-response": {
    "scopus-eid": "2-s2.0-85140054997",
    "originalText": "serial JL 271429 291210 291702 291731 291787 291877 291878 291881 31 90 Applied Energy APPLIEDENERGY 2022-10-18 2022-10-18 2022-10-18 2022-10-18 2022-10-29T02:57:53 1-s2.0-S0306261922013435 S0306-2619(22)01343-5 S0306261922013435 10.1016/j.apenergy.2022.120086 S300 S300.1 FULL-TEXT 1-s2.0-S0306261922X00196 2024-01-01T13:30:21.133674Z 0 0 20221201 2022 2022-10-18T02:12:58.640408Z articleinfo articlenumber articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright crossmark dateloaded dateloadedtxt datesearch datesort dateupdated dco docsubtype doctype doi eid ewtransactionid fundingbodyid hubeid indexeddate issn issnnorm itemstage itemtransactionid itemweight oauserlicense openaccess openarchive pg pgfirst pii piinorm pubdatestart pubdatetxt pubyr sectiontitle sortorder sponsoredaccesstype srctitle srctitlenorm srctype ssids alllist content oa subj subheadings suppl tomb volfirst volissue volumelist webpdf webpdfpagecount yearnav figure table body mmlmath acknowledge affil articletitle auth authfirstini authfull authkeywords authlast grantnumber grantsponsor grantsponsorid highlightsabst orcid primabst ref 0306-2619 03062619 UNLIMITED DEN21 true 327 327 C Volume 327 35 120086 120086 120086 20221201 1 December 2022 2022-12-01 2022 Research Papers article fla © 2022 The Authors. Published by Elsevier Ltd. LINEARQUADRATICGAUSSIANCONTROLADVANCEDCONTINUOUSTIMEDISTURBANCEMODELSFORBUILDINGTHERMALREGULATION THILKER C 1 Introduction 1.1 Main aim and contribution of the paper 1.2 Structure and outline of the paper 2 Continuous-time LQG control with embedded disturbance forecasts 2.1 Relation between forecasting and control 2.2 Discretisation of the continuous-time dynamics 2.2.1 Error quantification of the discretisation 2.3 Discretisation of the continuous-time objective function 3 Solution to the LQG control problem with embedded disturbance model 3.1 State estimation (filter) 3.2 Solution to the LQG optimal control problem 4 The smart building and disturbance model 4.1 The smart building model 4.2 The disturbance model 5 Numerical case study 5.1 Simulation setup 5.2 Comparison of performances between forecasting schemes 6 Conclusion CRediT authorship contribution statement Acknowledgements References CORRADI 2013 421 430 O MADSEN 2015 H HANDBOOKCLEANENERGYSYSTEMS CONTROLELECTRICITYLOADSINFUTUREELECTRICENERGYSYSTEMS JUNKER 2018 175 182 R JUNKER 2019 123 128 R THILKER 2021 329 380 C TOWARDSENERGYSMARTHOMES MODELPREDICTIVECONTROLBASEDSTOCHASTICGREYBOXMODELS RAWLINGS 2017 J MODELPREDICTIVECONTROLTHEORYCOMPUTATIONDESIGN ASTROM 2012 K INTRODUCTIONSTOCHASTICCONTROLTHEORY THILKER 2021 116889 C CHEN 2011 258 267 C MADSEN 1995 67 79 H OLDEWURTEL 2012 15 27 F WYTOCK 2017 2042 2047 M 2017AMERICANCONTROLCONFERENCE DYNAMICENERGYMANAGEMENTSCENARIOBASEDROBUSTMPC MAASOUMY 2014 M COMPARISONCONTROLSTRATEGIESFORENERGYEFFICIENTBUILDINGHVACSYSTEMS SALAKIJ 2016 345 358 S KANG 2014 1 19 C QI 2009 1659 1667 Q ERROUISSI 2017 2265 2277 R TAYLOR 2004 225 233 C BAGTERPJORGENSEN 2012 187 193 J DRGONA 2020 190 232 J BACHER 2009 1772 1783 P PINSON 2009 51 62 P GABSI 2017 F 6THINTERNATIONALCONFERENCESMARTCITIESGREENICTSYSTEMSSMARTGREENS ENERGYEFFICIENCYAMULTIZONEOFFICEBUILDINGMPCBASEDCONTROLSIMSCAPEMODELLING LAGO 2018 386 405 J ZAVALA 2010 1 7 V 2010INNOVATIVESMARTGRIDTECHNOLOGIES ECONOMICIMPACTSADVANCEDWEATHERFORECASTINGENERGYSYSTEMOPERATIONS JAZWINSKI 1970 A STOCHASTICPROCESSESFILTERINGTHEORY ZABCZYK 1981 25 31 J JORGENSEN 2004 J MOVINGHORIZONESTIMATIONCONTROL SINGH 2017 10 16 A HAUSSMANN 1982 302 311 U STOCHASTICDIFFERENTIALSYSTEMS OPTIMALCONTROLPARTIALLYOBSERVEDDIFFUSIONSVIASEPARATIONPRINCIPLE LUENBERGER 1971 596 602 D BOYD 2004 S CONVEXOPTIMIZATION NOCEDAL 2006 J NUMERICALOPTIMIZATION ANDERSEN 2000 13 24 K SALAKIJ 2016 345 358 S VEGALARA 2016 283 292 B HUUSOM 2012 1997 2007 J HAGDRUP 2016 171 176 M ANDERSEN 1977 B METEOROLOGICALDATAFORDESIGNBUILDINGINSTALLATIONAREFERENCEYEAR THILKERX2022X120086 THILKERX2022X120086XC Full 2022-10-07T12:35:02Z FundingBody Denmark institutions 2021 http://creativecommons.org/licenses/by/4.0/ 2024-10-18T00:00:00.000Z 2024-10-18T00:00:00.000Z http://creativecommons.org/licenses/by-nc-nd/4.0/ This is an open access article under the CC BY license. © 2022 The Authors. Published by Elsevier Ltd. 2022-10-25T06:27:35.978Z http://vtw.elsevier.com/data/voc/AddOnTypes/50.7/aggregated-refined 0 item S0306-2619(22)01343-5 S0306261922013435 1-s2.0-S0306261922013435 10.1016/j.apenergy.2022.120086 271429 2024-01-01T13:30:21.133674Z 2022-12-01 UNLIMITED DEN21 1-s2.0-S0306261922013435-main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/MAIN/application/pdf/2246371f9dfccd8c54e759c1fe193a00/main.pdf main.pdf pdf true 1547904 MAIN 10 1-s2.0-S0306261922013435-main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/PREVIEW/image/png/38cd20daa9fb4f26c031f31a40749107/main_1.png main_1.png png 62700 849 656 IMAGE-WEB-PDF 1 1-s2.0-S0306261922013435-gr2.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr2/DOWNSAMPLED/image/jpeg/f5152dd52897f8d0e0eac1b1f2aa00d5/gr2.jpg gr2 gr2.jpg jpg 91668 286 378 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr1/DOWNSAMPLED/image/jpeg/d4c61c3fd7a6105243f857b50b86e581/gr1.jpg gr1 gr1.jpg jpg 86880 227 354 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr4/DOWNSAMPLED/image/jpeg/c862d1fe2cf9ec00a651f3b1c0ff7a66/gr4.jpg gr4 gr4.jpg jpg 110847 472 376 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr3.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr3/DOWNSAMPLED/image/jpeg/c4ed54aac19878dcdba46e436d3b7f4d/gr3.jpg gr3 gr3.jpg jpg 85373 218 376 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr6.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr6/DOWNSAMPLED/image/jpeg/73c1fd9c5d55a695b379d7a9ce009bea/gr6.jpg gr6 gr6.jpg jpg 97769 285 602 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr5/DOWNSAMPLED/image/jpeg/9ac6321917db70064357a91f98db8c4e/gr5.jpg gr5 gr5.jpg jpg 108444 186 562 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr8.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr8/DOWNSAMPLED/image/jpeg/750eb762f717e467d9ca1473dc37487e/gr8.jpg gr8 gr8.jpg jpg 110564 244 357 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-fx1001.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/fx1001/DOWNSAMPLED/image/jpeg/8557eada3e1b0cd9cc021b7c82309edd/fx1001.jpg fx1001 fx1001.jpg jpg 99838 336 817 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr7.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr7/DOWNSAMPLED/image/jpeg/0c4f54a6c4bdfc7eae92715084bad6d1/gr7.jpg gr7 gr7.jpg jpg 168372 664 375 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-fx1002.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/fx1002/DOWNSAMPLED/image/jpeg/cc520decf0f50c511e19ef2688be5c27/fx1002.jpg fx1002 fx1002.jpg jpg 103530 274 817 IMAGE-DOWNSAMPLED 1-s2.0-S0306261922013435-gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr2/THUMBNAIL/image/gif/163016769225d8ee227d0170f8d28d69/gr2.sml gr2 gr2.sml sml 79036 164 216 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr1/THUMBNAIL/image/gif/547ce1db546e06c081b5de973bb33d2b/gr1.sml gr1 gr1.sml sml 71373 141 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr4/THUMBNAIL/image/gif/9db1a6c64d59d6ba3b1b9913d4a89dfb/gr4.sml gr4 gr4.sml sml 74062 163 130 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr3/THUMBNAIL/image/gif/982b1b1f7eae678facccebb4c86a7781/gr3.sml gr3 gr3.sml sml 71981 127 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr6.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr6/THUMBNAIL/image/gif/c2f952ab6c1dc86d41c45f76c3619cc2/gr6.sml gr6 gr6.sml sml 21163 104 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr5/THUMBNAIL/image/gif/9d0de9ba2e2c5d4f19f55f513deadcef/gr5.sml gr5 gr5.sml sml 71388 72 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr8.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr8/THUMBNAIL/image/gif/5defa43c08a6e26aa0e6f7e3054398d2/gr8.sml gr8 gr8.sml sml 80528 150 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-fx1001.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/fx1001/THUMBNAIL/image/gif/4462216557ccd9f43ced8a6375aeaffd/fx1001.sml fx1001 fx1001.sml sml 68664 90 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr7.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/gr7/THUMBNAIL/image/gif/989ab2bd8c1975d6f588ca692ae1836a/gr7.sml gr7 gr7.sml sml 75281 163 92 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-fx1002.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/fx1002/THUMBNAIL/image/gif/b413b5ee6969d435b017506ffca476aa/fx1002.sml fx1002 fx1002.sml sml 68952 74 219 IMAGE-THUMBNAIL 1-s2.0-S0306261922013435-gr2_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/65266d3a4463cfce16d13ccad3920dcb/gr2_lrg.jpg gr2 gr2_lrg.jpg jpg 244683 1269 1675 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr1_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/82c1e3672bbfafc45d9980866160d7d3/gr1_lrg.jpg gr1 gr1_lrg.jpg jpg 191704 1008 1569 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr4_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/a422532ed033541ddec3bc2a95a782fe/gr4_lrg.jpg gr4 gr4_lrg.jpg jpg 361322 2094 1667 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr3_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/0b5d806a9b79657598eaa3fc4fe0f707/gr3_lrg.jpg gr3 gr3_lrg.jpg jpg 164881 968 1667 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr6_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/c000f74d64adb453ec0b2c6945925c93/gr6_lrg.jpg gr6 gr6_lrg.jpg jpg 779725 1261 2667 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr5_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/b4c8aa33e5bdfcad822bb5847c33feae/gr5_lrg.jpg gr5 gr5_lrg.jpg jpg 356531 822 2489 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr8_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/75f1faffd772f501e8f43f447d6ec5b3/gr8_lrg.jpg gr8 gr8_lrg.jpg jpg 378262 1084 1583 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-fx1001_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/32807b9da1f649c8fe2de47bf61790af/fx1001_lrg.jpg fx1001 fx1001_lrg.jpg jpg 338308 1487 3618 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-gr7_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/ce31c69c20d8c9dfd6634974a5908c82/gr7_lrg.jpg gr7 gr7_lrg.jpg jpg 868033 2941 1661 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-fx1002_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0306261922013435/HIGHRES/image/jpeg/37afc2451a2fe2a98663be730026cc8c/fx1002_lrg.jpg fx1002 fx1002_lrg.jpg jpg 337649 1215 3618 IMAGE-HIGH-RES 1-s2.0-S0306261922013435-am.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/egi:109418Z135M/MAIN/application/pdf/613ecd66a177c15ace72079c199f17cc/am.pdf am am.pdf pdf false 1930529 AAM-PDF APEN 120086 120086 S0306-2619(22)01343-5 10.1016/j.apenergy.2022.120086 The Authors Fig. 1 An illustration of the calculations of the model discretisation. The disturbance model estimates the mean value in the time sample [ t k , t k + 1 ] . The slanted hatched area indicates the factor d t − d ̄ k and the vertical hatched area shows the exponential factor (in 1 dimension) in the integral in (11c). Fig. 2 Due to the Gaussian noise acting on the system, we do not know the deterministic position of the system \u2014 instead, the position is given by a Gaussian density, centred around x ˆ k | k . Fig. 3 A diagram of the smart building model and the interactions. The room air exchanges heat with the floor and the ambient air and is heated by electrical heaters. The solar radiation enters through the windows and typically delivers significant amounts of heat. Fig. 4 Two illustrations of how the climatic processes interact and how the disturbance model is designed. In 4(a) the two components of the solar radiation is displayed: The global radiation consists of direct- and diffuse radiation where the latter is reflected off from objects in the atmosphere. In 4(b), the interactions of the components near Earth\u2019s surface is depicted. The net radiation is the net input of short- and long wave radiation. It plays a crucial role in describing the ambient air temperature. The sea surrounding Denmark highly regulates the air temperature. The heat capacity of water is much larger compared to that of air, and the sea temperature ( T s ) thus acts as a slow and regulating component in the model. T ∞ represents a constant heat loss of the air. Fig. 5 The advanced dynamical disturbance model compared to persistent forecasts and true disturbances. Fig. 6 A simulation of a 14 day period with electricity prices taken from Nordpool and weights c u = 2 . 5 ⋅ 1 0 − 5 , r u = 1 ⋅ 1 0 − 6 . Fig. 7 Pareto fronts of the variation trade-off of the input and the set-point deviation 7(a) and the set-point deviation and the electricity price 7(b). Fig. 8 The savings in terms of the objective of the controllers using advanced- and perfect forecasts compared to a controller using persistent forecasts. The solid and dashed lines use r u = 0 and r u = 0 . 5 ⋅ 1 0 − 5 , respectively. E.g. The dashed lines at the weight c u = 0 . 0002 shows that the advanced- and persistent forecasts performs around 10% better compared to the persistent forecasts for r u = r u = 0 . 5 ⋅ 1 0 − 5 . Table 1 The values used in the model for a single smart building in (31). Parameter Value Unit C r 810 kJ/ ° C C f 3315 kJ/ ° C r r a 0.036 kJ/( ° C h) r f r 0.0016 kJ/( ° C h) A w 2.9 m 2 p 0.1 σ 1 0.1 σ 2 0.1 Linear quadratic Gaussian control with advanced continuous-time disturbance models for building thermal regulation Christian Ankerstjerne Thilker Conceptualization Methodology Software Validation Methodology Formal analysis Writing \u2013 original draft \u204e John Bagterp Jørgensen Conceptualization Supervision Writing \u2013 review & editing Henrik Madsen Conceptualization Supervision Writing \u2013 review & editing Technical University of Denmark, Department of Applied Mathematics and Computer Science, Asmussens Allé, Building 303B, DK-2800 Kgs. Lyngby, Denmark Technical University of Denmark, Department of Applied Mathematics and Computer Science Asmussens Allé, Building 303B Kgs. Lyngby DK-2800 Denmark o=Technical University of Denmark, Department of Applied Mathematics and Computer Science, a=Asmussens Allé, Building 303B, p=DK-2800, pp=, c=Kgs. Lyngby, cy=Denmark \u204e Corresponding author. This paper introduces a linear quadratic control scheme for a continuous-time system with observations taken at discrete times. Particular attention is given to the derivation of the disturbance terms in the model. Control performance may depend critical on accurate disturbance forecasts. This is the case for building climate control, where solar rays pass through e.g. windows and deliver significant amounts of energy and the dynamics can be very fast, fluctuating, and spontaneous. We thus argue that it is critical for control performance to sufficiently describe and include disturbances in the control description to obtain satisfactory control accuracy. We suggest and derive in details a control framework based on continuous-time stochastic differential equations (SDEs) and linear quadratic Gaussian control using an advanced continuous-time disturbance model to supply disturbance forecasts. The numerical simulation results suggest that control with embedded forecasts handles uncertainties well and provides up to 26% performance improvements compared to standard disturbance mitigation techniques. Furthermore, we demonstrate that the quadratic controller has a useful trade-off between variability in the control signal, economic cost, and variability around the reference point. Keywords Linear quadratic Gaussian control Stochastic differential equations Non-linear disturbance models Continuous-time Smart energy systems Data availability The authors do not have permission to share data. 1 Introduction As the share of renewable energy in the electricity grid continues to grow, related problems become more prominent. Among these problems are misalignments in energy production and consumption, voltage overload, congestion, etc. The traditional solution up to modern times has been to control the production such that the electricity demand is covered. However, in an efficient implementation of future weather-driven energy systems, this is no longer an option. One solution is to focus on demand-response methodologies to unlock and control the flexibility at the consumer side [1,2]. A lot of recent work therefore centre around the concept known as energy flexibility [3,4]. The idea is to control the demand to align it with the production by utilising the inherent energy storage in households and buildings (such as thermal mass or stationary batteries), see e.g. [5] for an introduction and specific application examples. A key technology for enabling this solution is sophisticated predictive control of buildings. A well described energy flexibility setup involves a two-level control structure, where the upper-level controller (e.g. for voltage) computes a price signal which shifts the overall energy demand of the lower level controllers (e.g. individual buildings) to times where the CO2-concentration in the electricity mix is lower [2,6]. Linear quadratic regulation (LQR) is a very well studied and applied control scheme due to its optimal linear control law and simplicity [7,8]. The linear quadratic Gaussian (LQG) regulator extends the LQR scheme by also considering Gaussian system noise. Hence, LQG deals with the stochastic case of LQR, which may be closer to reality [9]. Disturbances also constitute an important aspect of control [10]. The literature identifies the solar radiation and ambient air temperature as critical factors dictating the heating and cooling needs for buildings [11,12]. Model-based predictive control (MPC) for smart energy systems is an active research area with many examples of e.g. conventional [13], stochastic [14] and robust MPC [15]. The use of LQG control in the literature is not as widely used for HVAC systems where often the simpler LQR scheme is used instead [16\u201320]. Furthermore, the common standard for mitigating disturbances in control (such as weather disturbances for buildings) is to apply offset-free regulation, see e.g. Errouissi et al. [21] or Taylor et al. [22] for applications in building climate control. Here, one introduces an additional integrating state that is able to cancel out a constant disturbance. LQG optimal control minimises the quadratic deviation of a linear transformation of the states to a set-point. Thus, compared to certainty-equivalent linear control (such as economic MPC with linear costs on constraint violations), LQG control inherently deals with uncertainty in a different manner. The quadratic penalty steers the mean value of the system state into the reference signal. Linear cost on the other hand steers the median onto the reference point [23]. We discuss the differences and their consequences in more detail later. For building climate control that uses weather forecasts, one of the dominating standards is to use meteorological forecasts [24]. Such forecasts have the advantage of giving relatively accurate forecasts potentially several days ahead. However, they typically do not include solar radiation forecasts and tend to be less accurate for short-term purposes [25,26]. Many examples of short-term forecasting models exist in the literature, such as linear regression-based models [27], artificial neural networks [28], and more advanced time series techniques [29]. Thilker et al. [10] propose an SDE-based model for predicting key attributes such as the solar radiation and outdoor air temperature. This form has the advantage that it fits naturally in the building model description (which is also formulated using SDEs). This paper shows the benefits of using an embedded model for disturbance forecasts in a LQG control setup for a residential building and highlights possible savings. 1.1 Main aim and contribution of the paper This paper discusses the role of disturbances in dynamical systems in great details and relates it to building thermal control. We derive a zero-order hold discretised system and optimal control problem from the continuous-time system model of a building undergoing disturbances from the ambient air temperature and solar radiation. Furthermore, this paper develops a LQG control framework for a building thermal model with an embedded disturbance model that supplies short-term weather forecasts. We carry out a simulation study suggesting that the proposed LQG controller with embedded disturbance model performs almost as good as a controller that uses perfect disturbance forecasts. 1.2 Structure and outline of the paper This paper has the following structure. Section 2 describes the standard LQG control scheme and derives the optimal control law and state estimate. Section 3 presents, motivates and derives the optimal control problem for the extended multi-step LQG control, which also includes the electricity prices and accounts for the weather disturbances. Section 5 presents the numerical simulation-based results and Section 6 summarises the findings and discusses future work and possibilities. 2 Continuous-time LQG control with embedded disturbance forecasts This section introduces the continuous-time linear quadratic control problem. We start by describing the importance of conditional expectations of the future in predictive control. We also deal with the discretisation in time of the dynamics and the objective function and how to deal with disturbances in such discretisation. Zero-order hold is the dominating discretisation standard. However, such discretisation introduces additional error terms that may affect the performance, and thus are important to characterise. In this section, we discuss errors and their effects on the system. In this paper, we denote time dependence in subscript x ( t ) = x t and we use x k as short-hand notation for x t k . This paper deals with continuous-discrete time state space models on the following form [30] (1a) d x t = A c x t + B c u t + E c d t d t + G c d ω t (1b) d d t = f d ( d t , t ) d t + g d ( d t , t ) d ω t (1c) z t = H x t (1d) y k = C x k + v k , v k ∼ N ( 0 , Σ ) where x , u , and d are the system, input, and disturbance states, respectively. A c , B c and E c are matrices governing the state evolution, input, and disturbances, respectively. ω t is standard Brownian motion, y k is the observation, v k is the observation noise, and z t is the control variable. The disturbance model in (1b) is non-linear and can be used to forecast the disturbance states. Had the disturbances d t been described by a linear model, we could couple the building and weather states into a single state space model [ x t ⊺ , d t ⊺ ] ⊺ . The weather is, however, governed by strong non-linearities and cannot be treated as a linear system, which is why it is necessary to uncouple them. Section 4.2 elaborates on this. 2.1 Relation between forecasting and control In the following, let z t be a continuous-time stochastic process (not necessarily the same as in Eq. (1)). The following term measures the expected p -order moment between z t and a signal g t (2) E [ \u2016 z t − g t \u2016 p p | Y k ] , where \u2016 ⋅ \u2016 p is the usual p -norm of vectors, p ≥ 1 , and Y k = { y 0 , y 1 , \u2026 , y k } is all historic observations up till time t k . Putting p = 2 , we obtain the non-central second order moment. Such an objective measures the variance of a process. Now, let g t be controllable in the sense given in [31]. Given information until time t k , we can write the minimum-variance optimal control problem as (3) min g t ϕ k = ∫ t k t k + T E [ \u2016 z t − g t \u2016 2 2 | Y k ] d t , The optimal minimiser of the minimum-variance problem (3) can be shown to be the conditional expectation, g t = E [ z t | Y k ] : E \u2016 z t − g t \u2016 2 2 | Y k = E [ \u2016 z t − g t + E z t | Y k − E z t | Y k \u2016 2 2 | Y k ] = V z t | Y k + \u2016 E [ z t | Y k ] − g t \u2016 2 2 , where V z t | Y k denotes the conditional variance with respect to Y k . The above attains its minimum exactly for g t = E [ z t | Y k ] . This implies that we need to use conditional expectations to solve stochastic control problems with a quadratic cost function as in (3). Hence, we need to estimate the following (4) E [ { z t : t ≥ t k } | Y k ] = { z ˆ t | t k : t ≥ t k } . For linear systems with Gaussian noise, the Kalman filter is an optimal estimator of the conditional expectation. In a discrete form (which we derive in Section 2.2), the continuous-time system in Eq. (1) can be written (5) E [ x t k + 1 | Y k ] = A x ˆ k | k + B u k + E d ˆ k | k . Since the conditional expectation of the system state depends on disturbances, d t , we also need forecasts of the conditional expectations of these to do optimal predictive control. That is, we need to supply the following forecasts of the disturbances to the optimal control problem (6) E [ { d k + i } i = 0 N − 1 | Y k ] = { d ˆ k + i | k } i = 0 N − 1 . Note that putting p = 1 in (2) yields the absolute value, for which the median of z t is the optimal minimiser. By tilting the absolute value function appropriately, certain quantiles become the minimiser. This knowledge can be very useful in forming the right objective function to mimic the desired behaviour of the system. It might be that one side of the reference trajectory is a very expensive operational area, and thus shaping the objective to make the reference trajectory align with the 99% quantile may be appropriate. The quadratic objective function thus measures the squared norm of deviation between the conditional expectation of the stochastic process and the signal g t . However, as we shall also do in the present paper, it is very common to include additional terms in the quadratic cost function in (2) [23] such that the problem becomes (7) ϕ k = ∫ t k t k + T E [ \u2016 z t − r t \u2016 Q 2 ︸ objective + \u2016 u ̄ t − u t \u2016 R 2 ︸ regularisation + c t ⊺ u t ︸ economic cost | Y k ] where r t is a reference trajectory, u t is the control signal, and c t is a cost related to the input at time t . The subscripts Q and R denotes the weighted 2-norm (with weights Q and R ). For energy systems, this objective is appropriate for stabilising e.g. voltages in grids, aligning energy consumption of building stocks etc. The first regularisation term reflects the cost of the input deviating too much from a desired reference point. The second term typically reflects some economic costs related to input in time. In the context of building thermal control using a heat pump, the latter can be the electricity price related to the heat pump operations. 2.2 Discretisation of the continuous-time dynamics In this section, we derive a discretisation of the continuous time dynamical system in (1). Due to the discrete nature of the way computers perform numerics, it is necessary to somehow discretise the optimisation problem in (7). For energy systems, the disturbances typically play an important role and are themselves encumbered with uncertainty. We shall therefore put extra attention towards how to handle the disturbance term in (1), E c d t , in the discretisation. Let T s be the sample time between the control points, T s = t k + 1 − t k . We assume that the input u is constant during the time intervals [ t k , t k + 1 [ for all k ∈ N , i.e. zero-order hold. The solution to x t in (1) gets the form (8) x t k + 1 = A x t k + B u k + ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ d τ + ξ k , where the matrices A , B and process noise ξ k are defined by (9) A = exp A c T s , B = ∫ 0 T s exp A c τ B c d τ , ξ k = ∫ t k t k + 1 exp A c ( t k + 1 − τ ) G c d ω ( τ ) . A and B in (9) have known closed-form solutions and are easy to compute. However, it is not straightforward how to deal with the integral ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ d τ in (8). The rest of this section deals with this integral when disturbance forecasts are supplied as zero-order hold values. As Section 4 describes, the embedded disturbance model in (1b) estimates the mean value of the disturbances between time samples [ t k , t k + 1 [ , that is (10) d ̄ k = d ˆ k | k + ϵ k , t ∈ [ t k , t k + 1 [ . d ̄ k is the true mean value of the disturbances, d ˆ k | k = E [ d ̄ k | Y k ] is the conditional mean value supplied by the disturbance model given observations up till time t k , and ϵ k is i.i.d. Gaussian distributed white noise. To rewrite the system in (1) with the weather predictions, we can rewrite the integral in (8) as (11a) ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ + d ̄ k − d ̄ k d τ , (11b) = E d ̄ k + ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ − d ̄ k d τ , (11c) = E d ˆ k | k + E ϵ k + ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ − d ̄ k d τ , (11d) = E d ˆ k | k + E ϵ k + ζ k , (11e) ≈ E d ˆ k | k + E ϵ k + 0 , where E = ∫ 0 T s exp A c τ E c d τ . In (11e), it is assumed (wrongfully) that the disturbances act constantly on the system such that d τ − d ̄ k = 0 and the integral ζ k = ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ − d ̄ k d τ = 0 vanishes. The term ζ k can be thought of as the error related to the zero-order hold discretisation. Fig. 1 depicts the calculations involved in (11). The hatched areas indicate the two factors in the integral in (11c) between two time samples t k and t k + 1 . It becomes evident that the integral of the product of the two terms in general is not zero. Unfortunately, the disturbance processes are strongly non-linear and behave indescribably, which implies that d τ − d ̄ k becomes correlated in time (as Fig. 1 illustrates). For this reason, the easiest solution is to neglect the error as in (11e). Since the uncertainty of the disturbances is described by Brownian motions, it is possible to characterise the uncertainty of the disturbances between time samples using a Brownian bridge. In such a setup, by conditioning the Brownian bridge on attaining the estimated disturbance values at times { t k , t k + 1 } , the disturbance process between the time steps is Gaussian. It is then straight forward to compute uncertainties and densities for the disturbances at all points in time. Inserting (11e) into (8) gives us the system (12) x k + 1 = A x k + B u k + E d ˆ k | k + E ϵ k + ξ k , with x k = x t k and ϵ k ∼ N ( 0 , W 1 ) and ξ k ∼ N ( 0 , W 2 ) . W 1 is the covariance of the uncertainty related to the disturbance estimate and W 2 = ∫ 0 T s exp A c τ G c G c ⊤ exp A c ⊤ τ d τ . Aggregating the noise terms, w k = E ϵ k + ξ k , gives the conventional discrete-time stochastic state space system (13) x k + 1 = A x k + B u k + E d ˆ k | k + w k . It immediately reveals that the computation of E [ x k + i | Y k ] , i = 1 , \u2026 , N requires conditional mean forecasts of the disturbances. 2.2.1 Error quantification of the discretisation Since ζ k is difficult to determine, the easiest solution is to disregard it. But can we say something about the error we make by this simplification? The discretised system (with all its terms) gets the form: (14) x k + 1 = A x k + B u k + E d ˆ k | k + E ϵ k + ξ k + ζ k , where ζ k = ∫ t k t k + 1 exp A c ( t k + 1 − τ ) E c d τ − d ̄ k d τ . The error term ζ k can be bounded by the following: (15a) \u2016 ζ k \u2016 2 2 ≤ ∫ t k t k + 1 \u2016 exp A c ( t k + 1 − τ ) \u2016 F 2 d τ ⋅ \u2016 E \u2016 F 2 ⋅ max τ { \u2016 d τ − d ̄ k \u2016 2 2 } ≤ Δ t k ⋅ max τ { \u2016 exp A c ( t k + 1 − τ ) \u2016 F 2 } ⋅ \u2016 E c \u2016 F 2 (15b) ⋅ max τ { \u2016 d τ − d ̄ k \u2016 2 2 } The first two norms of (15b) are related to the singular values of the dynamics A and E \u2014i.e. if the dynamics are fast, the error might be larger (due to the matrix exponential that acts as a weighting factor) and vice versa. The last term relates the error to the maximum quadratic variation between the continuous process d τ and its mean value in the interval [ t k , t k + 1 [ . Note that the error term \u2016 ζ k \u2016 2 2 scales linearly in time, in line with the variance of a standard Brownian motion. Also note that had the weighting factor exp A c ( t k + 1 − τ ) not been present, the integral would simply vanish. It is hence the system\u2019s dynamical influence that causes the error of the zero order hold. 2.3 Discretisation of the continuous-time objective function The objective function has the purpose of weighting the performance of control solutions to make them comparable. E.g., typically, the purpose of controlling the indoor air temperature of a building is to maintain a comfortable temperature while minimising the electricity consumption and/or price (and perhaps more criteria such as variations in the input signal). It is thus a tuning problem to correctly weight the contributions to mimic desired behaviour. In the previous subsection, we obtained the system on a discrete-time form using a zero-order hold discretisation scheme. This has the advantage of parameterising the input signal as a set of values { u k + i } i = 0 N − 1 , which is numerically tractable in an optimisation problem. Given information up until time t k , Y k = { y 0 , y 1 , \u2026 , y k } the finite-horizon continuous-time LQG control objective function from Eq. (7) gets the form (16) E [ ∫ t k t k + T 1 2 ( z t − r t ) ⊺ Q ( z t − r t ) + 1 2 ( u ̄ t − u t ) ⊺ R ( u ̄ t − u t ) + c t ⊺ u t d t | Y k ] , where r t and u ̄ t are reference trajectories. Note that we employ the weighted 2-norm. How to discretise the objective function is not straight forward and can be done in multiple ways. In general, the discretisation is an approximation of the continuous-time objective. However, in the linear-quadratic case, an exact discretisation exists [32]. The derivation is tedious, though, and if the time between samples and control inputs is small, the integral can be approximated well by an Euler discretisation, i.e. evaluating the objective function point-wise. Let (17) t k ≤ t k + 1 ≤ ⋯ ≤ t k + N = t k + T be a partition of the future control times of the system. We discretise the objective function point-wise such that the integral in (16) becomes a sum over the values at the time points in (17) (18) ϕ = E [ ∑ i = k k + N − 1 1 2 ( z i − r i ) ⊺ Q ( z i − r i ) ︸ ϕ 1 + 1 2 ( u ̄ i − u i ) ⊺ R ( u ̄ i − u i ) ︸ ϕ 2 + c i ⊺ u i | Y k ] . Using that z i = H x i , the first term in the sum simplifies to (19) ϕ 1 = ∑ i = k k + N − 1 1 2 x i ⊤ Q \u2032 x i + s i ⊤ x k + 1 2 r k ⊤ Q r k where Q \u2032 = H ⊤ Q H and s i ⊤ = − r i ⊤ Q H . The second part of the objective function equivalently has the form (20) ϕ 2 = ∑ i = k k + N − 1 1 2 u i ⊤ R u i + u ̄ i ⊤ R u i + 1 2 u ̄ i ⊤ R u ̄ i The combined discretised objective function (where we omit terms that are independent of the system state or the input signal) is (21) ϕ d = E [ ∑ i = k k + N − 1 1 2 x i ⊤ Q \u2032 x i + s i ⊤ x i + 1 2 u i ⊤ R u i + u ̄ i ⊤ R u i + c i ⊤ u i | Y k ] . 3 Solution to the LQG control problem with embedded disturbance model The previous section presented and derived the discretisation of the system dynamics and objective function to make computations tractable for the computer. There are multiple ways to solve the LQG optimal control problem. Singh and Pal [33] derive an optimal linear feedback law based on the current state and future disturbance input \u2014 an extension to the classical LQR feedback law. However, such laws are not able to deal with constraints, which requires (in general) numerical solvers to solve. In this section, we derive solutions to the finite horizon constrained LQG optimal control problem. When dealing with stochastic systems as in (1) governed by both Gaussian system and observation noise, the LQG control problem can be divided into two sub-problems due to the separation principle (under certain conditions) [34]. Given a noisy observation of the system, y k , the steps are 1. Reconstruct the system states, x k , using the regular Kalman filter (which is an optimal state estimator in the linear case with Gaussian noise), i.e. x ˆ k | k = E [ x k | Y k ] 2. Solve the LQG optimal control problem using the reconstruction as a certainty-equivalent state estimate. The LQR and LQG optimal control problems are special cases when it comes to their solutions and ability to separate the estimation and optimal control problems. This section presents and solves both problems. 3.1 State estimation (filter) Due to the Gaussian error term in (13), w k = E ϵ k + ξ k , the system experiences random forces that pushes it away from its deterministic path given by the linear system in Eq. (5). We thus do not know the exact position of the system. To estimate the system state, filters and observers are common choices [30,35]. However, in case of a linear state space model with Gaussian process noise, the Kalman filter provides an optimal state estimator. It estimates a distribution of the system state at time t k , ( x k | Y k ) ∼ N ( x ˆ k | k , P ˆ k | k ) given the past observations. Fig. 2 depicts the distributional development in the Kalman filter update: We start out with an initial state estimate at time t k given by a distribution N ( x ˆ k | k , P ˆ k | k ) . The system development gives a predicted estimate of the successive state, ( x k + 1 | Y k ) ∼ N ( x ˆ k + 1 | k , P ˆ k + 1 | k ) . When the next observation, y k + 1 , becomes available, the Kalman filter combines the system prediction and the observation at time t k + 1 , to compute the optimal system state estimate, ( x k + 1 | Y k + 1 ) ∼ N ( x ˆ k + 1 | k + 1 , P ˆ k + 1 | k + 1 ) . Algorithm 1 lists the necessary computational steps in the Kalman filter to update the system state distribution. 3.2 Solution to the LQG optimal control problem Consider the following finite horizon, inequality constrained optimal control problem given x ˆ k | k and { d ˆ k + j | k } j = 0 N − 1 , (22a) U k ∗ | x ˆ k | k , { d ˆ k + j | k } j = 0 N − 1 = arg min u 0 , \u2026 , u N − 1 ϕ k (22b) s.t. x ˆ i + 1 = A x ˆ i + B u ˆ i + E d ˆ k + i | k , (22c) x ˆ 0 = x ˆ k | k (22d) u min ≤ u i ≤ u max (22e) Δu min ≤ Δu i ≤ Δu max (22f) i = 0 , \u2026 , N − 1 , with the discrete-time objective function (23) ϕ k = E [ ∑ i = k N − 1 + k 1 2 x ˆ i ⊤ Q \u2032 x ˆ i + s i ⊤ x ˆ i + 1 2 u i ⊤ R u i − u ̄ i ⊤ R u i + c i ⊤ u i | Y k ] . We solve the optimal control problem in (22) by introducing a notation for the system for all points in time from k = 0 , \u2026 , N − 1 . (24) X ˆ k + 1 = Φ x ˆ k | k + Γ u U k + Γ d D ˆ k where the matrices and vectors are (25) X ˆ k + 1 = x ˆ k + 1 | k ⊤ , \u2026 , x ˆ k + N | k ⊤ ⊤ U k = u k | k ⊤ , \u2026 , u k + N − 1 | k ⊤ ⊤ D ˆ k = d ˆ k | k ⊤ , \u2026 , d ˆ k + N − 1 | k ⊤ ⊤ S k = s k ⊤ , s k + 1 ⊤ , \u2026 , s k + N − 1 ⊤ ⊤ Φ = A ⊤ , ( A 2 ) ⊤ , \u2026 , ( A N ) ⊤ ⊤ Γ u = B 0 \u2026 0 A B B \u2026 0 A 2 B A B ⋱ ⋮ ⋮ ⋮ ⋱ 0 A N − 1 B A N − 2 B \u2026 B Γ d = E 0 \u2026 0 A E E \u2026 0 A 2 E A E ⋱ ⋮ ⋮ ⋮ ⋱ 0 A N − 1 E A N − 2 E \u2026 E We also introduce the vector containing the prediction errors ɛ k + i | k = x ˆ k + i | k − x k + i , i ∈ N , which are due to the Gaussian error term in (13), w k = E ϵ k + ξ k , (26) ɛ k = ɛ k + 1 | k ⊤ , \u2026 , ɛ k + N | k ⊤ ⊤ Inserting the new notation in to the objective function ultimately isolates the stochasticity to the prediction errors (the predictions and prediction errors are independent under the linear quadratic assumption) (27) ϕ k = E [ 1 2 X ˆ k + 1 + ɛ ⊤ Q ̄ X ˆ k + 1 + ɛ k + S k ⊤ X ˆ k + 1 + ɛ k + 1 2 U k ⊤ R ̄ U k − U ̄ k ⊤ R ̄ U k + C ̄ k ⊤ U k | Y k ] ϕ k = 1 2 X ˆ k + 1 ⊤ Q ̄ X ˆ k + 1 + S k ⊤ X ˆ k + 1 + 1 2 U k ⊤ R ̄ U k − U ̄ k ⊤ R ̄ U k + C ̄ k ⊤ U k + E 1 2 ɛ k ⊤ Q ̄ ɛ k + S k ⊤ ɛ k | Y k , where Q ̄ = diag ( Q \u2032 , \u2026 , Q \u2032 ) , R ̄ = diag ( R , \u2026 , R ) , and C ̄ k = c k ⊤ , \u2026 , c k + N − 1 ⊤ ⊤ . Since the last term does not depend on U , we can omit it in the optimisation problem. The next step is to insert (24) into the cost function (28) ϕ k = 1 2 Φ x ˆ k | k + Γ u U k + Γ d D ˆ k ⊤ Q ̄ ( Φ x ˆ k | k + Γ u U k + Γ d D ˆ k ) + S k ⊤ ( Φ x ˆ k | k + Γ u U k + Γ d D ˆ k ) + 1 2 U k ⊤ R ̄ U k − U ̄ k ⊤ R ̄ U k + C ̄ k ⊤ U k . Notice that we eliminated the equality constraints (22b) since they are now embedded in the cost function. We can write the objective, ϕ k , as a quadratic function in U k (29) ϕ ̃ k = 1 2 U k ⊤ P U k + q ⊤ U k , with the matrix and vector P = ( Γ u ⊤ Q ̄ Γ u + R ̄ ) q = ( Γ u ⊤ Q ̄ Φ x ˆ k | k + Γ u ⊤ Q ̄ Γ d D ˆ k + Γ u ⊤ S k + C ̄ k − R ̄ U ̄ k ) That is, the optimisation problem in (22) is equivalent to the following convex quadratic programme (30) U k ∗ | x ˆ k | k , { d ˆ k + j | k } j = 0 N − 1 = arg min u 0 , \u2026 , u N − 1 ϕ ̃ k s.t. u min ≤ u i ≤ u max Δu min ≤ Δu i ≤ Δu max i = 0 , \u2026 , N − 1 with ϕ ̃ k as in (29). The objective, ϕ ̃ k , is convex and enables fast numerical solvers such as interior-point methods, see e.g. [36]. Had the problem been unconstrained, the solution to the quadratic optimal control problem would have been given in closed-form [37]. This has the advantages of being fast to evaluate and gives useful insights into how the solution depends on the various parameters. The LQG control framework is now given by a filtering- and an optimisation step. Given an observation, y k , we reconstruct the current state, x ˆ k | k , in the filtering step, and solve the optimal control problem to retrieve the optimal input. In the MPC algorithm, we require an addition computational step to compute the disturbance forecasts. Algorithm 2 lists the LQG control framework. 4 The smart building and disturbance model In the numerical case study (to simulate the performance of controllers using different disturbance forecasting schemes) we consider the heat dynamics of a building given by a model based on SDEs. Furthermore, we use a SDE-based disturbance model to supply forecasts. This section introduces both models briefly. 4.1 The smart building model This paper considers a model based on SDEs with a linear model for the building heat dynamics and a non-linear model for the disturbances. The SDE representation in (1) provides a natural way to express physical systems due to the continuous-time formulation. This paper uses the continuous-time heat dynamics model of a building identified and estimated by [38]. The authors show that a sufficient model for describing the heat dynamics of the specific building involves two heat accumulating media temperatures: the room air and the floor. We denote the state variable x ( t ) = T r ( t ) , T f ( t ) T , where T r and T f are the room air and floor temperature, respectively. Furthermore, the authors identify how the important disturbances act on the smart building; that is the ambient air temperature, T a ( t ) , and the solar radiation, ϕ s ( t ) . Lastly the room is equipped with an electrical heater to supply heat. Fig. 3 illustrates the heat dynamics and interactions between the model components. Mathematically, the following matrices govern the continuous-time smart building model on linear form as in (1) (31) A c = − 1 r f r C r − 1 r r a C r 1 r f r C r 1 r f r C f − 1 r f r C f , B c = 1 C r 0 , E c = 1 r r a C r A w ( 1 − p ) C r 0 A w p C f , G c = σ 1 0 0 σ 2 , C = 1 0 , H = 1 0 with the variables x ( t ) = T r ( t ) , T f ( t ) T , u ( t ) = ϕ h ( t ) , d ( t ) = T a ( t ) , ϕ s ( t ) T . Table 1 gives the values and descriptions of the parameters in (31). The model in (31) is of course very simple and could be extended to include many effects such as the relative humidity or CO 2 -levels, both of which impacts the indoor climate [39]. 4.2 The disturbance model An important contribution of this paper is to show that disturbance modelling is crucial for control performance. We use the advanced dynamical disturbance model introduced in [6,10]. The disturbance model predicts the mean value of the solar radiation, ϕ s ( t ) , and the ambient air temperature, T a ( t ) , in the time interval [ t k , t k + 1 [ . The model is based on stochastic differential equations and incorporates many climate processes. Fig. 4 gives an overview of the model: It includes models of the following components \u2022 Cloud cover, κ \u2022 Global solar radiation (based on the direct and diffuse radiation), ϕ s \u2022 Net radiation, R n \u2022 Ambient air temperature, T a Fig. 4 illustrates the way the components are coupled and thoroughly explains the dynamics and interactions. Ultimately, the model predicts the amount of solar radiation hitting a horizontal surface (in Watts) and the ambient air temperature. That is, given an observation of the disturbances at time t k , y ˆ d , k , the disturbance model returns a sequence of disturbance forecasts (32) d ˆ k + i | k i = 0 N − 1 where d ˆ k + i | k = T a , k + i | k , ϕ s , k + i | k T is the prediction of the disturbances in the time interval t k + i , t k + i + 1 [ , i ∈ N and N is the prediction horizon. The building- and disturbance systems in (31) are one-way coupled and the observation of the building system does not contain much additional information about the disturbance state. For this reason, we let separate Kalman filters reconstruct each system for a given time instance. Furthermore, we let the MPC use the weather forecasts as input to the grey-box model for the disturbances to solve the optimal control problem. Fig. 5 shows a forecasting example with a prediction horizon of four days. The disturbance model forecasts the expected value, which visibly goes to a steady state after some time (after which the forecasts corresponds to a mean value). Remark The presented model includes only a limited climatic processes for predicting the ambient air temperature and global solar radiation. If relevant for the control objective, other variables could be added to the disturbance model \u2014 e.g. humidity factor, CO 2 , etc. 5 Numerical case study In this section, we carry out a simulation study to quantify the effects of using embedded disturbance forecasts for the continuous-time LQG controller based on the optimal control problem in (30) using the discretised dynamics and objective function in (13) and (21), respectively. We compare the results with a controller that uses perfect forecasts to give an upper bound on the possible control performance. We also compare a controller that uses offset-free control \u2014 also known as persistent forecasts. The latter is a standard way of dealing with disturbances in the control literature, see e.g. [40\u201342] for introductions to the technique. 5.1 Simulation setup To include weather disturbances into the simulations and mimic natural settings, we use actual weather data as the true disturbances acting on the building model. The controllers use weather predictions supplied by the disturbance forecasting schemes (either persistent, advanced, or perfect forecasts). The results in this section (simulation results in Figs. 7 and 8) are based on 7 months of weather data, where observations are separated by 1 h. The data was collected from a weather station located in Taastrup in Denmark in the period from 1971 to 1973. The data include the following variables: \u2022 Cloud cover ([okta]) \u2022 Direct radiation ([W/m 2 ]) \u2022 Diffuse radiation ([W/m 2 ]) \u2022 Net radiation ([W//m 2 ]) \u2022 Air temperature ([ ° C ]) For more details on the data, it is thoroughly described in [43]. The controllers use a prediction horizon of 84 h and a time sample of 1 h. The constraints on the input are u min = 0 W, u max = 1500 W, Δ u min = − 500 W, and Δ u max = 500 W. The electricity price is parameterised as c i = c u c ̄ i , where c ̄ i is electricity price data taken from Nordpool and c u is a constant scalar to weight the electricity price in the optimisation. To give a visual example of the control solution and better understand the differences of the strategies, Fig. 6 shows the first two weeks of the 7 months of the control simulation. The overall behavioural pattern seems to be more or less the same for all controllers. They tend to buy electricity at the same times. However, the controller using persistent forecasts seems to consistently overheat in periods with significant amounts of sun, compared to the other controllers. Here, the controllers using advanced and perfect forecasts seem to supply more equal control solutions. 5.2 Comparison of performances between forecasting schemes Fig. 7 shows the pareto-fronts displaying the trade-offs between variance in the signals and economic costs. Fig. 7(a) shows the trade-off between the variance of the solution and the control signal: If we require less variance of the process around the reference signal, the variance of the input increases and vice versa. This trade-off is a consequence of the LQG control that weights the variance of solution and the input. The controller using advanced forecasts is able to obtain smaller variation of the solution for a given tolerable input variation compared to persistent forecasts. Fig. 7(b) shows the trade-off between the variance in the solution and the economic costs. It shows again that it is more expensive to require less variation in the solution. Again, the controller using advanced forecasts is able to obtain a certain variation in the solution for a smaller economic cost. Overall, the advanced forecasts are able to deliver better solutions in terms of economic costs and variations in the input and solution. The performance is sometimes close to that of using perfect forecasts. Lastly, Fig. 8 shows the savings of controllers using perfect and advanced forecasts as a function of the economic price weight compared to a controller using persistent forecasts. The objective function savings are the realised savings: (33) Savings = 100 ⋅ ϕ ( method ) ϕ ( persistent ) , method ∈ { perfect , advanced } where ϕ ( method ) is the realised objective computed by evaluating the control solution (using either perfect- or advanced forecasts as forecasting scheme) in the objective function and ϕ ( persistent ) is the control solution using persistent forecasts evaluated in the objective function. It shows the savings for two values of r u (solid and dashed lines) where the results vary from 5% to 26 % savings by varying c u when using advanced forecasts (compared to a controller using persistent forecasts). By including the electricity price in the objective function (with varying electricity price) adds the objective of also using the electricity when it is cheaper. The results thus also give an idea of the strategies\u2019 abilities to shift the heat input to beneficial times. This result is in-line with the message from the pareto-fronts \u2014 the advanced forecasts supply better forecasts for control compared to persistent forecasts, and for certain choices of parameters the performance is close to that of perfect forecasts. It is also visible that adding more regularisation to the optimal control problem (by increasing the weight c u ) the performance between the methods gets smaller. 6 Conclusion This paper introduced and treated in detail the continuous-time linear quadratic Gaussian (LQG) optimal control problem where disturbances are supplied by an embedded disturbance model. We derived a zero-order hold discretisation of the continuous-time dynamics and treated the effects of the disturbances in depth. Next, we introduced the LQG control framework consisting of a filter and an optimal control problem and presented an algorithm to solve the problem. We carried out a numerical case study that involved controlling the indoor climate of a building using the proposed LQG control framework with an embedded disturbance model to supply weather forecasts. We compared the control performance to controllers using persistent forecasts (which is the otherwise dominating standard to supply forecasts). Results suggest control performance improvements up to 26% are available from using an embedded disturbance model. We also showed that the LQG control framework leads to a useful trade-off between variation of the input, variation of the output, and economic costs. CRediT authorship contribution statement Christian Ankerstjerne Thilker: Conceptualization, Methodology, Software, Validation, Methodology, Formal analysis, Writing \u2013 original draft. John Bagterp Jørgensen: Conceptualization, Supervision, Writing \u2013 review & editing. Henrik Madsen: Conceptualization, Supervision, Writing \u2013 review & editing. Declaration of Competing Interest The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgements The authors received funding from the following projects; Sustainable plus energy neighbourhoods (syn.ikia) (H2020 No. 869918), Centre for IT-Intelligent Energy Systems (CITIES) (DSF 1305-00027B), Top-Up (Innovation Fund Denmark 9045-00017B), SCA+ (Interreg Öresund-Kattegat-Skagerrak), Research Centre on Zero Emission Neighbourhoods in Smart Cities (FME-ZEN) (Research Council of Norway, No. 257660), and Flexible Energy Denmark (FED) (Innovation Fund Denmark 8090-00069B). References [1] Corradi O. Ochsenfeld H.P. Madsen H. Pinson P. Controlling electricity consumption by forecasting its response to varying prices IEEE Trans Power Syst 28 1 2013 421 430 10.1109/TPWRS.2012.2197027 O. Corradi, H. P. Ochsenfeld, H. Madsen, P. Pinson, Controlling electricity consumption by forecasting its response to varying prices, I E E E Transactions on Power Systems 28 (2013) 421\u2013430. 10.1109/TPWRS.2012.2197027. [2] Madsen H. Parvizi J. Halvgaard R.F. Sokoler L.E. Jørgensen J.B. Hansen L.H. Control of electricity loads in future electric energy systems Conejo A.J. Dahlquist E. Yan J. Handbook of clean energy systems 2015 Wiley H. Madsen, J. Parvizi, R. F. Halvgaard, L. E. Sokoler, J. B. Jørgensen, L. H. Hansen, K. B. Hilger, Control of electricity loads in future electric energy systems, Handbook of Clean Energy Systems (2015). [3] Junker R.G. Azar A.G. Lopes R.A. Lindberg K.B. Reynders G. Relan R. Characterizing the energy flexibility of buildings and districts Appl Energy 225 2018 175 182 10.1016/j.apenergy.2018.05.037 R. G. Junker, A. G. Azar, R. A. Lopes, K. B. Lindberg, G. Reynders, R. Relan, H. Madsen, Characterizing the energy flexibility of buildings and districts, Applied Energy 225 (2018) 175\u201382. 10.1016/j.apenergy.2018.05.037. [4] Junker R.G. Relan R. Madsen H. Designing individual penalty signals for improved energy flexibility utilisation IFAC-PapersOnLine 52 4 2019 123 128 10.1016/j.ifacol.2019.08.166 R. G. Junker, R. Relan, H. Madsen, Designing individual penalty signals for improved energy flexibility utilisation, IFAC-PapersOnLine 52 (2019) 123\u2013128. https://doi.org/10.1016/j.ifacol.2019.08.166. [5] Jensen SØ, Parker J, Engelmann P, Joanna A. Examples of energy flexibility in buildings. Technical report, 1600-3780ISBN: 978-87-93250-12-3, 2019. S. Østergaard Jensen, J. Parker, P. Engelmann, A. Joanna, Examples of Energy Flexibility in Buildings, Technical Report, 2019. [6] Thilker C. Junker R. Bacher P. Jørgensen J. Madsen H. Model predictive control based on stochastic grey-box models Towards energy smart homes 2021 Springer 329 380 10.1007/978-3-030-76477-7_11 C. Thilker, R. Junker, P. Bacher, J. Jørgensen, H. Madsen, Model Predictive Control Based on Stochastic Grey-Box Models, Towards Energy Smart Homes, Springer, 2021, pp. 329\u2013380. 10.1007/978-3-030-76477-7_11. [7] Schildbach G, Goulart P, Morari M. The Linear Quadratic Regulator with chance constraints. In: 2013 european control conference. 2013, p. 2746\u201351. G. Schildbach, P. Goulart, M. Morari, The linear quadratic regulator with chance constraints, in: 2013 European Control Conference (ECC), 2013, pp. 2746\u20132751. [8] Rawlings J. Mayne D.Q. Diehl M. Model predictive control: Theory, computation, and design 2017 Nob Hill Publishing J. Rawlings, D. Mayne, M. Diehl, Model Predictive Control: Theory, Computation, and Design, Nob Hill Publishing, 2017. [9] Åström K.J. Introduction to stochastic control theory 2012 Courier Corporation K. J. Åström, Introduction to stochastic control theory, Courier Corporation, 2012. [10] Thilker C. Madsen H. Jørgensen J. Advanced forecasting and disturbance modelling for model predictive control of smart energy systems Appl Energy 292 2021 116889 10.1016/j.apenergy.2021.116889 C. Thilker, H. Madsen, J. Jørgensen, Advanced forecasting and disturbance modelling for model predictive control of smart energy systems, Applied Energy 292 (2021) 116889. 10.1016/j.apenergy.2021.116889. [11] Chen C. Duan S. Cai T. Liu B. Hu G. Smart energy management system for optimal microgrid economic operation IET Renew Power Gener 5 3 2011 258 267 C. Chen, S. Duan, T. Cai, B. Liu, G. Hu, Smart energy management system for optimal microgrid economic operation, IET Renewable Power Generation 5 (2011) 258\u2013267. [12] Madsen H. Holst J. Estimation of continuous-time models for the heat dynamics of a building Energy Build 22 1995 67 79 H. Madsen, J. Holst, Estimation of continuous-time models for the heat dynamics of a building, Energy and Building 22 (1995) 67\u201379. [13] Halvgaard R, Poulsen NK, Madsen H, Jørgensen JB. Economic Model Predictive Control for building climate control in a Smart Grid. In: 2012 IEEE PES innovative smart grid technologies. 2012, p. 1\u20136. R. Halvgaard, N. K. Poulsen, H. Madsen, J. B. Jørgensen, Economic model predictive control for building climate control in a smart grid, in: 2012 IEEE PES Innovative Smart Grid Technologies (ISGT), 2012, pp. 1\u20136. [14] Oldewurtel F. Parisio A. Jones C.N. Gyalistras D. Gwerder M. Stauch V. Use of model predictive control and weather forecasts for energy efficient building climate control Energy Build 45 2012 15 27 10.1016/j.enbuild.2011.09.022 URL: http://www.sciencedirect.com/science/article/pii/S0378778811004105 F. Oldewurtel, A. Parisio, C. N. Jones, D. Gyalistras, M. Gwerder, V. Stauch, B. Lehmann, M. Morari, Use of model predictive control and weather forecasts for energy efficient building climate control, Energy and Buildings 45 (2012) 15 \u2013 27. http://www.sciencedirect.com/science/article/pii/S0378778811004105. https://doi.org/10.1016/j.enbuild.2011.09.022. [15] Wytock M. Moehle N. Boyd S. Dynamic energy management with scenario-based robust MPC 2017 American control conference 2017 2042 2047 10.23919/ACC.2017.7963253 M. Wytock, N. Moehle, S. Boyd, Dynamic energy management with scenario-based robust mpc, in: 2017 American Control Conference (ACC), 2017, pp. 2042\u20132047. 10.23919/ACC.2017.7963253. [16] Maasoumy M. Vincentelli A. Comparison of control strategies for energy efficient building HVAC systems 2014 10.13140/2.1.4813.0560 M. Maasoumy, A. Vincentelli, Comparison of control strategies for energy efficient building hvac systems, 2014. 10.13140/2.1.4813.0560. [17] Salakij S. Yu N. Paolucci S. Antsaklis P. Model-based predictive control for building energy management. In: Energy modeling and optimal control Energy Build 133 2016 345 358 10.1016/j.enbuild.2016.09.044 URL: http://www.sciencedirect.com/science/article/pii/S0378778816308908 S. Salakij, N. Yu, S. Paolucci, P. Antsaklis, Model-based predictive control for building energy management. in: Energy modeling and optimal control, Energy and Buildings 133 (2016) 345 \u2013 358. http://www.sciencedirect.com/science/article/pii/S0378778816308908. https://doi.org/10.1016/j.enbuild.2016.09.044. [18] Kang C.-S. Park J.-I. Park M. Baek J. Novel modeling and control strategies for a HVAC system including carbon dioxide control Energies 7 6 2014 1 19 URL: https://ideas.repec.org/a/gam/jeners/v7y2014i6p3599-3617d36704.html C.-S. Kang, J.-I. Park, M. Park, J. Baek, Novel Modeling and Control Strategies for a HVAC System Including Carbon Dioxide Control, Energies 7 (2014) 1\u201319. https://ideas.repec.org/a/gam/jeners/v7y2014i6p3599-3617d36704.html. [19] Bayati Poudeh M, Mahdavian M. New adaptive controller in a two area HVAC/HVDC power system. In: 2008 11th International conference on optimization of electrical and electronic equipment. 2008, p. 131\u20136. M. Bayati Poudeh, M. Mahdavian, New adaptive controller in a two area HVAC/HVDC power system, in: 2008 11th International Conference on Optimization of Electrical and Electronic Equipment, 2008, pp. 131\u2013136. [20] Qi Q. Deng S. Multivariable control of indoor air temperature and humidity in a direct expansion (DX) air conditioning (A/C) system Build Environ 44 8 2009 1659 1667 10.1016/j.buildenv.2008.11.001 URL: http://www.sciencedirect.com/science/article/pii/S0360132308002679 Q. Qi, S. Deng, Multivariable control of indoor air temperature and humidity in a direct expansion (dx) air conditioning (a/c) system, Building and Environment 44 (2009) 1659 \u2013 1667. http://www.sciencedirect.com/science/article/pii/S0360132308002679. https://doi.org/10.1016/j.buildenv.2008.11.001. [21] Errouissi R. Al-Durra A. Muyeen S.M. Leng S. Blaabjerg F. Offset-free direct power control of DFIG under continuous-time model predictive control IEEE Trans Power Electron 32 3 2017 2265 2277 R. Errouissi, A. Al-Durra, S. M. Muyeen, S. Leng, F. Blaabjerg, Offset-free direct power control of DFIG under continuous-time model predictive control, IEEE Transactions on Power Electronics 32 (2017) 2265\u20132277. [22] Taylor C.J. Leigh P. Price L. Young P.C. Vranken E. Berckmans D. Proportional-integral-plus (PIP) control of ventilation rate in agricultural buildings Control Eng Pract 12 2 2004 225 233 C. Taylor, P. Leigh, L. Price, P. Young, E. Vranken, D. Berckmans, Proportional-integral-plus (PIP) control of ventilation rate in agricultural buildings, Control Engineering Practice 12 (2004) 225 \u2013 233. [23] Bagterp Jørgensen J. Frison G. Fog Gade-Nielsen N. Damman B. Numerical methods for solution of the extended linear quadratic control problem IFAC Proc Vol 45 17 2012 187 193 10.3182/20120823-5-NL-3013.00092 URL: https://www.sciencedirect.com/science/article/pii/S1474667016314483, 4th IFAC Conference on Nonlinear Model Predictive Control J. Bagterp Jørgensen, G. Frison, N. Fog Gade-Nielsen, B. Damman, Numerical methods for solution of the extended linear quadratic control problem, IFAC Proceedings Volumes 45 (2012) 187\u2013193. https://www.sciencedirect.com/science/article/pii/S1474667016314483. https://doi.org/10.3182/20120823-5-NL-3013.00092, 4th IFAC Conference on Nonlinear Model Predictive Control. [24] Drgoňa J. Arroyo J. Cupeiro Figueroa I. Blum D. Arendt K. Kim D. All you need to know about model predictive control for buildings Annu Rev Control 50 2020 190 232 10.1016/j.arcontrol.2020.09.001 URL: https://www.sciencedirect.com/science/article/pii/S1367578820300584 J. Drgoňa, J. Arroyo, I. Cupeiro Figueroa, D. Blum, K. Arendt, D. Kim, E. P. Ollé, J. Oravec, M. Wetter, D. L. Vrabie, L. Helsen, All you need to know about model predictive control for buildings, Annual Reviews in Control 50 (2020) 190\u2013232. https://www.sciencedirect.com/science/article/pii/S1367578820300584. https://doi.org/10.1016/j.arcontrol.2020.09.001. [25] Bacher P. Madsen H. Nielsen H.A. Online short-term solar power forecasting Sol Energy 83 10 2009 1772 1783 10.1016/j.solener.2009.05.016 URL: https://www.sciencedirect.com/science/article/pii/S0038092X09001364 P. Bacher, H. Madsen, H. A. Nielsen, Online short-term solar power forecasting, Solar Energy 83 (2009) 1772\u20131783. https://www.sciencedirect.com/science/article/pii/S0038092X09001364. https://doi.org/10.1016/j.solener.2009.05.016. [26] Pinson P. Madsen H. Nielsen H.A. Papaefthymiou G. Klöckl B. From probabilistic forecasts to statistical scenarios of short-term wind power production Wind Energy 12 1 2009 51 62 10.1002/we.284 arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/we.284 P. Pinson, H. Madsen, H. A. Nielsen, G. Papaefthymiou, B. Klöckl, From probabilistic forecasts to statistical scenarios of short-term wind power production, Wind Energy 12 (2009) 51\u201362. https://onlinelibrary.wiley.com/doi/abs/10.1002/we.284. https://doi.org/10.1002/we.284. arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/we.284. [27] Gabsi F. Hamelin F. Pannequin R. Chaabane M. Energy efficiency of a multizone office building: MPC-based control and simscape modelling 6th international conference on smart cities and green ICT Systems, SMARTGREENS Porto, Portugal 2017 10.5220/0006305002270234 F. Gabsi, F. Hamelin, R. Pannequin, M. Chaabane, Energy efficiency of a multizone office building: MPC-based control and Simscape modelling, in: 6th International Conference on Smart Cities and Green ICT Systems, SMARTGREENS, Porto, Portugal, 2017. 10.5220/0006305002270234. [28] Lago J. De Ridder F. De Schutter B. Forecasting spot electricity prices: Deep learning approaches and empirical comparison of traditional algorithms Appl Energy 221 2018 386 405 J. Lago, F. De Ridder, B. De Schutter, Forecasting spot electricity prices: Deep learning approaches and empirical comparison of traditional algorithms, Applied Energy 221 (2018) 386\u2013405. [29] Zavala V.M. Constantinescu E.M. Anitescu M. Economic impacts of advanced weather forecasting on energy system operations 2010 innovative smart grid technologies 2010 1 7 10.1109/ISGT.2010.5434772 V. M. Zavala, E. M. Constantinescu, M. Anitescu, Economic impacts of advanced weather forecasting on energy system operations, in: 2010 Innovative Smart Grid Technologies (ISGT), 2010, pp. 1\u20137. 10.1109/ISGT.2010.5434772. [30] Jazwinski A. Stochastic processes and filtering theory Mathematics in science and engineering 1970 Acad. Press New York, NY [u.a.] A. Jazwinski, Stochastic processes and filtering theory, number 64 in Mathematics in science and engineering, Acad. Press, New York, NY [u.a.], 1970. [31] Zabczyk J. Controllability of stochastic linear systems Systems Control Lett 1 1 1981 25 31 10.1016/S0167-6911(81)80008-4 URL: https://www.sciencedirect.com/science/article/pii/S0167691181800084 J. Zabczyk, Controllability of stochastic linear systems, Systems & Control Letters 1 (1981) 25\u201331. https://www.sciencedirect.com/science/article/pii/S0167691181800084. https://doi.org/10.1016/S0167-6911(81)80008-4. [32] Jørgensen J. Moving horizon estimation and control (Ph.D. thesis) 2004 Technical University of Denmark J. Jørgensen, Moving Horizon Estimation and Control, Ph.D. thesis, 2004. [33] Singh A.K. Pal B.C. An extended linear quadratic regulator for LTI systems with exogenous inputs Automatica 76 2017 10 16 10.1016/j.automatica.2016.10.014 URL: http://www.sciencedirect.com/science/article/pii/S000510981630406X A. K. Singh, B. C. Pal, An extended linear quadratic regulator for lti systems with exogenous inputs, Automatica 76 (2017) 10 \u2013 16. http://www.sciencedirect.com/science/article/pii/S000510981630406X. https://doi.org/10.1016/j.automatica.2016.10.014. [34] Haussmann U.G. Optimal control of partially observed diffusions via the separation principle Stochastic differential systems 1982 Springer 302 311 U. Haussmann, Optimal control of partially observed diffusions via the separation principle, in: Stochastic Differential Systems, Springer, 1982, pp. 302\u2013311. [35] Luenberger D. An introduction to observers IEEE Trans Automat Control 16 6 1971 596 602 D. Luenberger, An introduction to observers, IEEE Transactions on Automatic Control 16 (1971) 596\u2013602. [36] Boyd S. Vandenberghe L. Convex optimization 2004 Cambridge University Press 10.1017/CBO9780511804441 S. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2004. 10.1017/CBO9780511804441. [37] Nocedal J. Wright S.J. Numerical optimization 2nd ed 2006 Springer New York, NY, USA J. Nocedal, S. J. Wright, Numerical Optimization, second ed., Springer, New York, NY, USA, 2006. [38] Andersen K.K. Madsen H. Hansen L.H. Modelling the heat dynamics of a building using stochastic differential equations Energy Build 31 1 2000 13 24 K. K. Andersen, H. Madsen, L. H. Hansen, Modelling the heat dynamics of a building using stochastic differential equations, Energy and Buildings 31 (2000) 13 \u2013 24. [39] Salakij S. Yu N. Paolucci S. Antsaklis P. Model-based predictive control for building energy management. I: Energy modeling and optimal control Energy Build 133 2016 345 358 10.1016/j.enbuild.2016.09.044 URL: https://www.sciencedirect.com/science/article/pii/S0378778816308908 S. Salakij, N. Yu, S. Paolucci, P. Antsaklis, Model-based predictive control for building energy management. i: Energy modeling and optimal control, Energy and Buildings 133 (2016) 345\u2013358. https://www.sciencedirect.com/science/article/pii/S0378778816308908. https://doi.org/10.1016/j.enbuild.2016.09.044. [40] Vega Lara B.G. Castellanos Molina L.M. Monteagudo Yanes J.P. Rodríguez Borroto M.A. Offset-free model predictive control for an energy efficient tropical island hotel Energy Build 119 2016 283 292 B. G. Vega Lara, L. M. Castellanos Molina, J. P. Monteagudo Yanes, M. A. Rodríguez Borroto, Offset-free model predictive control for an energy efficient tropical island hotel, Energy and Buildings 119 (2016) 283 \u2013 292. [41] Huusom J.K. Poulsen N.K. Jørgensen S.B. Jørgensen J.B. Tuning SISO offset-free model predictive control based on ARX models J Process Control 22 10 2012 1997 2007 J. K. Huusom, N. K. Poulsen, S. B. Jørgensen, J. B. Jørgensen, Tuning siso offset-free model predictive control based on ARX models, Journal of Process Control 22 (2012) 1997 \u2013 2007. [42] Hagdrup M. Boiroux D. Mahmoudi Z. Madsen H. Kjølstad Poulsen N. Poulsen B. On the significance of the noise model for the performance of a linear MPC in closed-loop operation IFAC-PapersOnLine 49 7 2016 171 176 10.1016/j.ifacol.2016.07.241 URL: https://www.sciencedirect.com/science/article/pii/S2405896316304487, 11th IFAC Symposium on Dynamics and Control of Process SystemsIncluding Biosystems DYCOPS-CAB 2016 M. Hagdrup, D. Boiroux, Z. Mahmoudi, H. Madsen, N. Kjølstad Poulsen, B. Poulsen, J. B. Jørgensen, On the significance of the noise model for the performance of a linear MPC in closed-loop operation, IFAC-PapersOnLine 49 (2016) 171\u2013176. https://www.sciencedirect.com/science/article/pii/S2405896316304487. https://doi.org/10.1016/j.ifacol.2016.07.241, 11th IFAC Symposium on Dynamics and Control of Process SystemsIncluding Biosystems DYCOPS-CAB 2016. [43] Andersen B. Eidorff S. Perdersen H.L.E. Rosenørn S. Valbjørn O. Meteorological data for design of building and installation: A reference year Technical report 66 1977 Thermal Insulation Laboratory Technical University of Denmark B. Andersen, S. Eidorff, H. L. E. Perdersen, S. Rosenørn, O. Valbjørn, Meteorological Data for Design of Building and Installation: A Reference Year, Technical Report 66, Thermal Insulation Laboratory, 1977. Technical University of Denmark.",
    "scopus-id": "85140054997",
    "coredata": {
        "eid": "1-s2.0-S0306261922013435",
        "dc:description": "This paper introduces a linear quadratic control scheme for a continuous-time system with observations taken at discrete times. Particular attention is given to the derivation of the disturbance terms in the model. Control performance may depend critical on accurate disturbance forecasts. This is the case for building climate control, where solar rays pass through e.g. windows and deliver significant amounts of energy and the dynamics can be very fast, fluctuating, and spontaneous. We thus argue that it is critical for control performance to sufficiently describe and include disturbances in the control description to obtain satisfactory control accuracy. We suggest and derive in details a control framework based on continuous-time stochastic differential equations (SDEs) and linear quadratic Gaussian control using an advanced continuous-time disturbance model to supply disturbance forecasts. The numerical simulation results suggest that control with embedded forecasts handles uncertainties well and provides up to 26% performance improvements compared to standard disturbance mitigation techniques. Furthermore, we demonstrate that the quadratic controller has a useful trade-off between variability in the control signal, economic cost, and variability around the reference point.",
        "openArchiveArticle": "false",
        "prism:coverDate": "2022-12-01",
        "openaccessUserLicense": "http://creativecommons.org/licenses/by/4.0/",
        "prism:aggregationType": "Journal",
        "prism:url": "https://api.elsevier.com/content/article/pii/S0306261922013435",
        "dc:creator": [
            {
                "@_fa": "true",
                "$": "Thilker, Christian Ankerstjerne"
            },
            {
                "@_fa": "true",
                "$": "Jørgensen, John Bagterp"
            },
            {
                "@_fa": "true",
                "$": "Madsen, Henrik"
            }
        ],
        "link": [
            {
                "@_fa": "true",
                "@rel": "self",
                "@href": "https://api.elsevier.com/content/article/pii/S0306261922013435"
            },
            {
                "@_fa": "true",
                "@rel": "scidir",
                "@href": "https://www.sciencedirect.com/science/article/pii/S0306261922013435"
            }
        ],
        "dc:format": "application/json",
        "openaccessType": "Full",
        "pii": "S0306-2619(22)01343-5",
        "prism:volume": "327",
        "articleNumber": "120086",
        "prism:publisher": "The Authors. Published by Elsevier Ltd.",
        "dc:title": "Linear quadratic Gaussian control with advanced continuous-time disturbance models for building thermal regulation",
        "prism:copyright": "© 2022 The Authors. Published by Elsevier Ltd.",
        "openaccess": "1",
        "prism:issn": "03062619",
        "dcterms:subject": [
            {
                "@_fa": "true",
                "$": "Linear quadratic Gaussian control"
            },
            {
                "@_fa": "true",
                "$": "Stochastic differential equations"
            },
            {
                "@_fa": "true",
                "$": "Non-linear disturbance models"
            },
            {
                "@_fa": "true",
                "$": "Continuous-time"
            },
            {
                "@_fa": "true",
                "$": "Smart energy systems"
            }
        ],
        "openaccessArticle": "true",
        "prism:publicationName": "Applied Energy",
        "openaccessSponsorType": "FundingBody",
        "prism:pageRange": "120086",
        "pubType": "fla",
        "prism:coverDisplayDate": "1 December 2022",
        "prism:doi": "10.1016/j.apenergy.2022.120086",
        "prism:startingPage": "120086",
        "dc:identifier": "doi:10.1016/j.apenergy.2022.120086",
        "openaccessSponsorName": "Denmark institutions 2021"
    },
    "objects": {"object": [
        {
            "@category": "standard",
            "@height": "286",
            "@width": "378",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr2.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "91668",
            "@ref": "gr2",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "227",
            "@width": "354",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr1.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "86880",
            "@ref": "gr1",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "472",
            "@width": "376",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr4.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "110847",
            "@ref": "gr4",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "218",
            "@width": "376",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr3.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "85373",
            "@ref": "gr3",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "285",
            "@width": "602",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr6.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "97769",
            "@ref": "gr6",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "186",
            "@width": "562",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr5.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "108444",
            "@ref": "gr5",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "244",
            "@width": "357",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr8.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "110564",
            "@ref": "gr8",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "336",
            "@width": "817",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1001.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "99838",
            "@ref": "fx1001",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "664",
            "@width": "375",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr7.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "168372",
            "@ref": "gr7",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "274",
            "@width": "817",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1002.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "103530",
            "@ref": "fx1002",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "thumbnail",
            "@height": "164",
            "@width": "216",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr2.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "79036",
            "@ref": "gr2",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "141",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr1.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "71373",
            "@ref": "gr1",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "163",
            "@width": "130",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr4.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "74062",
            "@ref": "gr4",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "127",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr3.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "71981",
            "@ref": "gr3",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "104",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr6.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "21163",
            "@ref": "gr6",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "72",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr5.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "71388",
            "@ref": "gr5",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "150",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr8.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "80528",
            "@ref": "gr8",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "90",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1001.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "68664",
            "@ref": "fx1001",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "163",
            "@width": "92",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr7.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "75281",
            "@ref": "gr7",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "74",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1002.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "68952",
            "@ref": "fx1002",
            "@mimetype": "image/gif"
        },
        {
            "@category": "high",
            "@height": "1269",
            "@width": "1675",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr2_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "244683",
            "@ref": "gr2",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1008",
            "@width": "1569",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr1_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "191704",
            "@ref": "gr1",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "2094",
            "@width": "1667",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr4_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "361322",
            "@ref": "gr4",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "968",
            "@width": "1667",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr3_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "164881",
            "@ref": "gr3",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1261",
            "@width": "2667",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr6_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "779725",
            "@ref": "gr6",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "822",
            "@width": "2489",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr5_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "356531",
            "@ref": "gr5",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1084",
            "@width": "1583",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr8_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "378262",
            "@ref": "gr8",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1487",
            "@width": "3618",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1001_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "338308",
            "@ref": "fx1001",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "2941",
            "@width": "1661",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-gr7_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "868033",
            "@ref": "gr7",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1215",
            "@width": "3618",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-fx1002_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "337649",
            "@ref": "fx1002",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0306261922013435-am.pdf?httpAccept=%2A%2F%2A",
            "@multimediatype": "Acrobat PDF file",
            "@type": "AAM-PDF",
            "@size": "1930529",
            "@ref": "am",
            "@mimetype": "application/pdf"
        }
    ]},
    "link": {
        "@rel": "abstract",
        "@href": "https://api.elsevier.com/content/abstract/scopus_id/85140054997"
    }
}}