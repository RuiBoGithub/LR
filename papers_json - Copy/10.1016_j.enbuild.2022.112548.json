{"full-text-retrieval-response": {
    "scopus-eid": "2-s2.0-85140296306",
    "originalText": "serial JL 271089 291210 291731 291800 291881 31 Energy and Buildings ENERGYBUILDINGS 2022-10-17 2022-10-17 2022-10-22 2022-10-22 2022-12-16T22:57:09 1-s2.0-S0378778822007198 S0378-7788(22)00719-8 S0378778822007198 10.1016/j.enbuild.2022.112548 S300 S300.2 FULL-TEXT 1-s2.0-S0378778822X00212 2024-04-16T11:25:12.855531Z 0 0 20221215 2022 2022-10-17T06:15:27.094331Z articleinfo articlenumber articletitlenorm authfirstinitialnorm authfirstsurnamenorm cid cids contenttype copyright crossmark dateloaded dateloadedtxt datesearch datesort dateupdated dco docsubtype doctype doi eid ewtransactionid hubeid indexeddate issn issnnorm itemstage itemtransactionid itemweight openaccess openarchive pg pgfirst pii piinorm pubdatestart pubdatetxt pubyr sectiontitle sortorder srctitle srctitlenorm srctype ssids alllist content subj subheadings suppl tomb volfirst volissue volumelist webpdf webpdfpagecount yearnav figure table body mmlmath acknowledge affil articletitle auth authfirstini authfull authkeywords authlast footnotes otherkwds primabst ref 0378-7788 03787788 true 277 277 C Volume 277 28 112548 112548 112548 20221215 15 December 2022 2022-12-15 2022 Research Articles article fla © 2022 Elsevier B.V. All rights reserved. MODELPREDICTIVECONTROLFORDYNAMICINDOORCONDITIONINGINPRACTICE HAMP Q 1 Introduction 2 Literature review 2.1 Model type for MPC 2.2 System identification 2.3 Planning configurable and extendable load reductions 2.4 Robust control with limited computational power 3 Methodology 3.1 Pre-processing 3.2 Identification 3.3 Planning 3.3.1 Optimization function indoor temperature 3.3.2 Optimization function SH-power 3.3.3 Optimization function smoothness SH-power 3.3.4 Constraints 3.3.5 Constraints of a DSM-event 3.4 Control 3.5 Method of evaluation based on dynamic simulations 4 Results 4.1 Performance evaluation 4.2 Showcase of DSM-events 5 Discussion and future developments 6 Conclusion Acknowledgment References MASTERS 2013 G RENEWABLEEFFICIENTELECTRICPOWERSYSTEMS SUN 2013 101 114 Y VESELY 2014 401 408 M MORARI 1999 667 682 M MYHREN 2008 524 536 J WERNSTEDT 2003 F MULTIAGENTSYSTEMSFORDISTRICTHEATINGMANAGEMENT FOUCQUIER 2013 272 288 A AFRAM 2014 343 355 A SERALE 2018 631 G GHOLAMZADEHMIR 2020 102480 M MARIANOHERNANDEZ 2021 101692 D BIANCHINI 2016 159 170 G MA 2012 92 100 J PEAN 2019 101579 T MAASOUMY 2012 26 35 M GOYAL 2021 S ADVANCEDCONTROLSFORINTELLIGENTBUILDINGS ZONG 2017 1476 1486 Y ARROYO 2022 118346 J BEROUINE 2022 9127 9141 A GOY 2015 3391 3396 S RADECKI 2012 3056 3062 P MADSEN 1995 67 79 H BACHER 2011 1511 1522 P HEDEGAARD 2017 982 987 R BLUM 2019 410 425 D THILKER 2021 111457 C LEPRINCE 2022 112095 J BACHER 2016 107 112 P OMAR 2015 F ASELFLEARNINGALGORITHMFORTEMPERATUREPREDICTIONINASINGLEFAMILYRESIDENCE LI 2014 517 537 X KNUDSEN 2017 937 942 M AKO 2016 J METHODFORCONTROLLINGHEATINGINBUILDINGS OLDEWURTEL 2012 15 27 F OLDEWURTEL 2010 1927 1932 F 49THIEEECONFERENCEDECISIONCONTROLCDC REDUCINGPEAKELECTRICITYDEMANDINBUILDINGCLIMATECONTROLUSINGREALTIMEPRICINGMODELPREDICTIVECONTROL PICARD 2017 739 751 D CARLI 2020 781 R CHEN 2015 357 369 X JIN 2017 4147 4152 X GUSTAFSSON 2000 F ADAPTIVEFILTERINGCHANGEDETECTION DRGONA 2015 J MODELPREDICTIVECONTROLAPPLICATIONSINBUILDINGTHERMALCOMFORTCONTROL PARKINSON 2016 T THERMALPLEASUREALLIESTHESIAINBUILTENVIRONMENT DING 2019 326 335 X BRANDI 2020 110225 S HAMPX2022X112548 HAMPX2022X112548XQ 2024-10-22T00:00:00.000Z 2024-10-22T00:00:00.000Z http://creativecommons.org/licenses/by-nc-nd/4.0/ © 2022 Elsevier B.V. All rights reserved. 2022-10-28T01:43:45.037Z http://vtw.elsevier.com/data/voc/AddOnTypes/50.7/nlp-car The authors are most grateful for the support of the data-science service provider Knowtion GmbH, Karlsruhe, Germany and in particular to Dr. Frederik Beutler who has accompanied this development with his expertise. 0 https://doi.org/10.15223/policy-017 https://doi.org/10.15223/policy-037 https://doi.org/10.15223/policy-012 https://doi.org/10.15223/policy-029 https://doi.org/10.15223/policy-004 item S0378-7788(22)00719-8 S0378778822007198 1-s2.0-S0378778822007198 10.1016/j.enbuild.2022.112548 271089 2022-12-16T23:20:47.172135Z 2022-12-15 1-s2.0-S0378778822007198-main.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/MAIN/application/pdf/d4bec5fa15d01ec64b36aa6873664e48/main.pdf main.pdf pdf true 2866591 MAIN 15 1-s2.0-S0378778822007198-main_1.png https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/PREVIEW/image/png/4bad9e49086eb8ff4e3f0aedfe91b25d/main_1.png main_1.png png 57097 849 656 IMAGE-WEB-PDF 1 1-s2.0-S0378778822007198-gr10.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr10/DOWNSAMPLED/image/jpeg/66008c3d0e46bbc2554c4f866e11a611/gr10.jpg gr10 gr10.jpg jpg 79877 648 517 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr3.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr3/DOWNSAMPLED/image/jpeg/708c11c6a58f73cd63603c3ea3d75575/gr3.jpg gr3 gr3.jpg jpg 55539 254 385 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr8.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr8/DOWNSAMPLED/image/jpeg/d6b91123aa0d96fcd9780678234a8660/gr8.jpg gr8 gr8.jpg jpg 32851 232 655 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr9.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr9/DOWNSAMPLED/image/jpeg/36983c3fb6f578563769094bb48f2196/gr9.jpg gr9 gr9.jpg jpg 73571 398 669 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr11.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr11/DOWNSAMPLED/image/jpeg/22d2504cb9554e5020909961a1f74fd3/gr11.jpg gr11 gr11.jpg jpg 63528 503 774 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr2.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr2/DOWNSAMPLED/image/jpeg/75d8c2e9d6d4c0e7d11144e3183ebd32/gr2.jpg gr2 gr2.jpg jpg 25555 243 661 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr4.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr4/DOWNSAMPLED/image/jpeg/3de4ca2bf727f5cc2f9dbee08ab77ff6/gr4.jpg gr4 gr4.jpg jpg 52467 323 663 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr5.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr5/DOWNSAMPLED/image/jpeg/f0ac3999c6386fe44f037d387807bf9d/gr5.jpg gr5 gr5.jpg jpg 70087 437 531 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr6.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr6/DOWNSAMPLED/image/jpeg/fad68d16b83584b9b04ef3d51cfc87a5/gr6.jpg gr6 gr6.jpg jpg 84753 384 663 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr7.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr7/DOWNSAMPLED/image/jpeg/edd5ea255ede03401026f615614474b7/gr7.jpg gr7 gr7.jpg jpg 32053 357 587 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr1.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr1/DOWNSAMPLED/image/jpeg/815ba5fb61fd24a7233318ddf3cc9970/gr1.jpg gr1 gr1.jpg jpg 64164 419 597 IMAGE-DOWNSAMPLED 1-s2.0-S0378778822007198-gr10.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr10/THUMBNAIL/image/gif/a65063c95518717a8da14c07097c6182/gr10.sml gr10 gr10.sml sml 9749 163 130 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr3.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr3/THUMBNAIL/image/gif/879ea52e8724ae77baa68292e4ebf5d7/gr3.sml gr3 gr3.sml sml 10652 145 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr8.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr8/HIGHRES/image/gif/3eab6e9ab76e481dd6f9d04e54c31a9b/gr8.sml gr8 gr8.sml sml 5290 77 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr9.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr9/THUMBNAIL/image/gif/803d11cb64229610ef78cf0477781a68/gr9.sml gr9 gr9.sml sml 8043 130 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr11.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr11/THUMBNAIL/image/gif/8210775990a335fdc551df3b239aee1e/gr11.sml gr11 gr11.sml sml 8172 142 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr2.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr2/THUMBNAIL/image/gif/f99198b26375ab43226e5feea9feb36c/gr2.sml gr2 gr2.sml sml 3926 80 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr4.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr4/THUMBNAIL/image/gif/3d313a5de8b16ffae632ec03ba28105e/gr4.sml gr4 gr4.sml sml 7805 107 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr5.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr5/THUMBNAIL/image/gif/622958c85016734c64e4f949323ce96c/gr5.sml gr5 gr5.sml sml 12451 164 199 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr6.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr6/THUMBNAIL/image/gif/67a7b0506abe65b32db7ff27257ceab9/gr6.sml gr6 gr6.sml sml 10143 127 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr7.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr7/THUMBNAIL/image/gif/6010325a6e9fca29d4e3e2a11e9f6180/gr7.sml gr7 gr7.sml sml 6319 133 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr1.sml https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/gr1/THUMBNAIL/image/gif/3d9ea8a146b9a2c3ba0ed845251ba1ab/gr1.sml gr1 gr1.sml sml 10025 154 219 IMAGE-THUMBNAIL 1-s2.0-S0378778822007198-gr10_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/f85d95fff4a72a359d9ce6330405051c/gr10_lrg.jpg gr10 gr10_lrg.jpg jpg 629742 2869 2288 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr3_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/116906dc5192cde84bb677d65ea2058c/gr3_lrg.jpg gr3 gr3_lrg.jpg jpg 330554 1128 1707 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr8_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/ac543da360a226b1cff299949f22148f/gr8_lrg.jpg gr8 gr8_lrg.jpg jpg 211186 1026 2901 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr9_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/ba04a9a1bb10d6429c728623ba1b5217/gr9_lrg.jpg gr9 gr9_lrg.jpg jpg 464468 1762 2963 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr11_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/fdfb02bb31d34c30c79846a894a19870/gr11_lrg.jpg gr11 gr11_lrg.jpg jpg 475411 2226 3427 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr2_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/dce4c2e0bd69e9a747f5bda38397ba7c/gr2_lrg.jpg gr2 gr2_lrg.jpg jpg 171052 1076 2929 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr4_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/be6c702a3c6f6f2f095db55c6acb3dcf/gr4_lrg.jpg gr4 gr4_lrg.jpg jpg 394337 1431 2937 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr5_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/72c215561fdcaaad1170acf4a4729f94/gr5_lrg.jpg gr5 gr5_lrg.jpg jpg 728638 1935 2350 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr6_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/39e7324ca2eaa5074c579b024739bed6/gr6_lrg.jpg gr6 gr6_lrg.jpg jpg 948802 1702 2937 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr7_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/09545565a10cd145c375c223985eb6b5/gr7_lrg.jpg gr7 gr7_lrg.jpg jpg 230192 1582 2601 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-gr1_lrg.jpg https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/pii:S0378778822007198/HIGHRES/image/jpeg/1b20cd064e1b791a9186f748e4ec935b/gr1_lrg.jpg gr1 gr1_lrg.jpg jpg 472657 1858 2645 IMAGE-HIGH-RES 1-s2.0-S0378778822007198-am.pdf https://s3-eu-west-1.amazonaws.com/prod-ucs-content-store-eu-west/content/egi:107HGX9SPBP/MAIN/application/pdf/b60193aa2703df337193ad87c0a38ace/am.pdf am am.pdf pdf false 2016831 AAM-PDF ENB 112548 112548 S0378-7788(22)00719-8 10.1016/j.enbuild.2022.112548 Elsevier B.V. Fig. 1 The functional dependencies of the services for MPC. Fig. 2 Model in electrical analogy with wall, SH-circuit, interior, ambient air and decoupled solar influence on interior and on the wall. Fig. 3 Estimation error for each week if model parameters of a specific week is used. The area of a dot represents the normalized error. Fig. 4 Identification, model manager, and planning. Fig. 5 Exemplary influence of planning parameters on the indoor temperature and SH-power trajectories. Fig. 6 SH-control logic based on closed-loop control of indoor temperature and open-loop control of supply temperature. Fig. 7 Temporal overlap of control plans to assure robustness in plan execution. Fig. 8 Simulation environment used for evaluation of method. On the right hand is the model of the building including its conventional HVAC-system. On the left is the higher level-controller with MPC and the temperature control. A REST API injects the virtual weather observations and forecasts, DSM-events, and exchange signals. Fig. 11 Simulation results enabling a direct comparison between open-loop control and MPC. MPC realizes a more stable indoor temperature while introducing higher dynamics in SH-power. Fig. 9 Planning of a load reduction including pre-loading with a prediction horizon of 5 days and a sampling period of 1 h. The continuous red line with dot markers represents the estimation of the possible power reduction. Fig. 10 Result of a simulation including multiple DSM-events with pre-loading. In the upper figure state represents which kind of control is active (1 PID, 2 MPC, 4 Pre-loading, 5 Post-loading, 6 Load reduction). Realistic outdoor climate has been used. Table 1 Planning parameters for configurable DSM. Column \u201cParam type\u201d indicates whether parameter is configurable on building (local) or on DH-network (global) level. ID Parameter Notation Param type Unit Range Comments 1 Pre-Loading Charge T-Offset Δ T pre global K [0\u20131.5] 2 Pre-Loading Duration Δ t pre global min [0\u2013180] 3 Pre-Loading Overshoot max α pre global % [0\u2013200] 4 Post-Loading Duration Δ t post global min [0\u2013360] 5 Post-Loading Overshoot max α post global % [0\u2013200] 6 Load Reduction Duration Δ t red global min [0\u2013360] duration till nominal state is reached again. P is unconstrained 7 Load Reduction Discharge T-Offset Δ T red local K [0\u20131.5] 8 Load Reduction min SH-temperature T min , SH local C [20\u201350] cold draught prevention 9 Load Reduction α red global % [0\u2013100] 10 Discharge drift δ discharge local kW/s [−0.5 to 0] 11 Charge drift δ charge local kW/s [0\u20130.5] 12 Acceptable Temperature fluctuation upper set Δ T set , upper local K [0\u20133] 13 Acceptable Temperature fluctuation lower set Δ T set , lower local K [0\u20133] 14 Set Temperature T set local C [18\u2013x] x dependent on user choice Table 2 Performance Key Performance Indicator of various configurations evaluated in simulations. Config. Control T set [C] E [MWh] T rep [C] e set , rep [K] σ T rep [K] T avg [C] e set , avg [K] σ T avg [K] 1 Open-loop 22.00 6.90 21.53 −0.47 1.11 21.83 −0.17 1.18 2 Closed-loop PID 22.00 6.90 21.63 −0.37 0.62 21.89 −0.11 0.65 3 MPC 21.63 6.89 21.63 0.00 0.11 21.88 +0.25 0.21 4 MPC 22.00 7.10 22.00 0.00 0.08 22.25 +0.25 0.20 5 MPC 21.13 6.61 21.14 +0.01 0.15 21.39 +0.26 0.23 Model predictive control for dynamic indoor conditioning in practice Quirin Hamp a \u204e Fabian Levihn a b a Stockholm Exergi AB, Jägmästargatan 2, 115 77 Stockholm, Sweden Stockholm Exergi AB Jägmästargatan 2 115 77 Stockholm Sweden Stockholm Exergi AB, Jägmästargatan 2, 115 77 Stockholm, Sweden b Royal Institute of Technology \u2013 KTH, Stockholm, Sweden Royal Institute of Technology \u2013 KTH Stockholm Sweden Royal Institute of Technology - KTH, Stockholm, Sweden \u204e Corresponding author. The capability to dynamically plan, predict, and control indoor conditioning allows to adapt to individual preferences of inhabitants and enables demand side management. While former mainly improves thermal comfort of inhabitants so does latter unlock ecological and financial opportunities mostly for energy utilities. Commonly, dynamic indoor conditioning is based on piece-wise constant indoor temperature constraints. This paper\u2019s contribution is the presentation of additional constraints: in particular ones expressed relative to the nominal behavior of a hydronic heating system. This allows to simultaneously harness the relevant process variables in particular during the pre-loading and post-loading phases of a load reduction. The findings are based on data sets acquired on 10 inhabited, residential buildings in Stockholm over a whole year. One of the findings is that building models need to be adaptable if predictive control is applied in practice. This adaptability is assured by a novel concept, i.e. a so called model manager on which the control is relying for the selection of the most accurate model. Centralized optimal control of buildings connected to a district heating network is challenging in practice due to a high computational load. In order to reduce it, the herein presented method elaborates plans only every hour instead of at every control step for optimal control. Since these plans cannot be optimal due to the lack of regular update a hitherto unknown cascaded control logic has been developed that corrects planning errors and other disturbances. Capabilities are demonstrated and compared to conventional controllers in dynamic simulations of a multi-zoned building. The herein presented method is to our knowledge the first to provide all flexibility desired by energy utilities and inhabitants alike through harnessing the consequences of transitions. Keywords Model predictive control Demand side management Load reduction Configurability Building heating Thermal storage Thermal comfort Demand forecasting State space District heating system Modeling Energy efficiency Building simulation Abbreviations DH District Heating DHW Domestic Hot Water DSM Demand Side Management HVAC Heating Ventilation Air Condtionning HX Heat Exchanger MFH Multiple Family House MPC Model Predictive Control PID Proportional Integral Derivative PMV Predicted Mean Vote QoS Quality of Service QP Quadratic Programming SH Space Heating 1 Introduction The optimization of energy production and the rationalization of indoor conditioning serve ecological and economical interests alike and can be achieved by dynamically conditioning indoors [1]. Commonly, dynamic conditioning with a Heating Ventilation and Air Conditioning (HVAC)-system is achieved by modifying the indoor temperature setpoint that fosters a change of conditioning power. If the modification of the setpoint consists of a constant offset and does not respect the thermal characteristics of a building, in particular its thermal mass and isolation, it has following consequences: power peaks or drops occur that compromise the supply/demand balance of the grid and the delay in indoor temperature response causes discomfort to inhabitants. Furthermore, this approach does not provide a prediction of system behavior in particular for the transient periods. Accurate predictions are required for production planning, though. This applies particularly if Domestic Hot Water (DHW)-consumption peaks shall be compensated by a reduction of Space Heating (SH)-load. The reason is that such peaks last only a couple of hours (usually less than 3 h) thus the thermal system response may not have settled 1 1 Observation made for buildings in Stockholm that is generalizable for the ones with similar thermal characteristics. , i.e. steady state is not reached. Therefore, the value of this flexibility is dependent on the accuracy of plans and their execution. This study contributes with a robust control method taking into consideration practical aspects of a potentially commercial exploitation in District Heating (DH)-networks such as the one in Stockholm with approximately 15 000 delivery points, i.e. substations that indirectly connect buildings with the DH-network. The objective of the herein presented study was to develop a holistic method capable of adapting the indoor climate to the individual preferences of inhabitants and enabling so called Demand Side Management (DSM). DSM commonly refers to programs implemented by energy utility companies to control the consumption at the customer or load side of the meter [1], so called load reduction 2 2 Another employed term is \u201cdemand response\u201d, but does not apply since the presented method is not based on incentives to which the demand is responding. . More specifically in this paper load related to the hydronic conditioning through radiators of residential buildings is considered thus the focus lies on DSM for utility companies operating a DH-network. At least two phases of DSM must be distinguished when applied to indoor conditioning: the load reduction and the rebound phase, i.e. post-loading. Load shedding strategies 3 3 Refer to [2] for definitions of load shedding and shifting. have the disadvantage that the duration of the rebound phase cannot be controlled, i.e. limited in duration. However, inhabitants\u2019 acceptance of load reductions is likely dependent on this duration: as longer the period during which comfort expectations are not met, as less acceptance there is. In contrast, peak shifting has the advantage that the rebound phase can be controlled in its duration. Regarding the rationalization of indoor conditioning the objective is to improve thermal comfort through individualization (see [3]) in dependency of which inhabitant is present. In case of a vacancy, energy savings should materialize. Both cases require dynamic conditioning and smooth transitions of regimes such as from an inhabited to a vacant interior, to a load reduction, or to a pre-loading period. The consequences of these transitions shall be predictable and controllable, i.e. not cause undesired system responses. If the prize-model for heat consumption in DH-networks has no daytime-dependent prize structure, conventional incentive based strategies like for DSM in electrical grids are practically not feasible. These strategies have the advantage that consumers\u2019 consent can be implied. In contrast, their consent cannot be implied for supervisory control strategies. In a Multiple Family House (MFH) in which the control is performed on building level, requiring consent of all inhabitants would jeopardize DSM since consensus is difficult to achieve. Therefore, a supervisory strategy has been chosen. In order to circumvent a potentially missing consent of inhabitants, the constraint was imposed that the effects of load reductions shall be unnoticeable or at least cause a negligible deterioration in Quality of Service (QoS) (less than 0.5 K change in room temperature) over a limited duration. A method how to enforce these constraints has been developed. One well known control logic potentially able to satisfy the objective of this study is Model Predictive Control (MPC). It is a control logic that uses an explicit process model to predict outputs of the system and controls under consideration of future inputs and outputs to be expected [4]. This enables for instance to reject disturbances and to satisfy constraints. However, several aspects needed further investigation that are presented in the following. MPC is based on a model that allows the prediction of system behavior. This study has analyzed which kind of model is particularly suited and if a system model can be universal. One result of the study is that there is no universal model and that prediction capability of models identified by conventional methods is poor. Therefore, a logic had to be found how to better identify, manage, and select multiple models to be used in MPC over more than one year with limited storage and computational capacities. During real load reduction tests, customers have complained about thermal discomfort, caused among others by cold air down draught from windows (see [5]). This study has investigated ways how to avoid discomfort and even extend the load reduction by pre-loading strategies. The required configurability of DSM-events and earlier studies showing that power peaks occur after load reductions [6] required a study how transitions could be harnessed. Therefore, this study elaborates additional constraints such as smoothness and relative ones to the nominal thermal behavior of a building. The computational load for optimal control \u2013if an optimization is performed for every control step for several thousands of buildings in a centralized manner\u2013 was deemed nowadays economically too expensive albeit potentially feasible with current scalable cloud computing infrastructures. Therefore, an optimal plan is calculated only once per hour and building. As a consequence, the control assuring the execution of these plans is more affected by disturbances. This paper presents a new control logic that is capable to palliate this collateral disadvantages by an auto-corrective execution of predictive plans. In order to better understand the choices made in this study a brief literature review of the state of art of dynamic conditioning of interiors is presented first in the reminder of this paper. The methodology is presented in Section 3 which comprises the suggested MPC setup and a description how it has been evaluated in dynamic simulations. The presentation of the control setup focuses on following processes: pre-processing, identification, planning, and control. In Section 4, the results of simulations on a MFH are compared to conventional controllers. Finally, after discussing the results and future work, conclusions about the presented MPC-method enabling DSM will be drawn. 2 Literature review The aim of this literature review is to help the reader understand the context and choices that have been made in the development of the herein presented MPC allowing dynamic indoor conditioning. It elaborates on pros and cons of earlier related works, but no attempt is made to categorize and comprehensively review all literature of this field. For comprehensive reviews refer to following sources [2,7\u201311]. The first discussed aspect is which type of model to be used in MPC. Secondly, anticipating that physical models are favored, the questions arose which model to use and how to identify system behavior. Therefore, insights on these topics will be provided. Thirdly, a review of methods is provided that aim at reducing the computational load required to support MPC. Finally, the state of art in planning a configurable load reduction and its extension through pre-loading is presented. 2.1 Model type for MPC MPC can be based on different types of models: Either so called statistical approaches, i.e. black box or physical approaches, i.e. white or grey-box ones are employed (see e.g. [12,13] or [14,15], respectively). The arguments for the decision to use a grey-box model is well described in [16] and are detailed further in the following. For the purpose of configurable DSM on building level, MPC shall control scenarios that might not be available in the training data set on which models are identified. Therefore, it seems safer to use a physical model which confirms statement found in [17]. Despite the potential lower fit performance of a physical model compared to a statistical one, the enforcement of physical laws such as energy conservation assures expectable system behavior in form of feasible process variables. This applies in particular if the system operates in non-steady-state conditions which is inevitable during DSM. This is a property that black-box model may not assure. In [18], an interesting combination of reinforcement learning and MPC is presented. However, this publication was not available during development of the herein presented approach. Another issue are disturbances in the training data set which unfortunately are common in practice due to the occupants\u2019 behavior. A white-box model fails if not all disturbances are observable which is the case under economical limitations. For instance, the requirement of occupancy prediction algorithms presented in the MPC approach of [19] seems avoidable if a grey-box model is used. Therefore, a grey-box model seems the most appropriate choice. One of the major advantages of MPC based on grey-box models is that the elaboration of an optimal plan can respect constraints on physical parameters [20] which is required for instance to satisfy comfort constraints. 2.2 System identification The goal of a modelization is to be able to identify and predict the dominant system behavior. An excellent review on building modeling can be found in [7]. A first practical challenge considering the application at hand is the selection of a model structure that produces acceptable prediction results for multiple buildings. The motivation to find a single model structure was rooted in the desire to reduce complexity. Common in white and grey-box building models used in MPC is a description of thermodynamics by using the electrical analogy, i.e. RC-networks. Once the ordinary differential equations of these networks established, they are transformed in state-space representation. Among the first publications were [21,22] using this analogy that has allowed the analysis of models with varying complexities as presented in [23,24]. Even if methods are presented in [23,25] how to determine the most appropriate model for a single building, it was unclear whether a whole building stock could be covered with a single model structure and/or a single set of model parameters over a whole year. The multitude of models presented in [23] allowed to select by try and error the simplest model capable to predict the behavior of most of the buildings in Stockholm\u2019s DH-network. The model presented in recent publication [26] is worth to be mentioned since it allows to model the return temperature of the SH-circuit which if of importance to optimize DH-network efficiency. Furthermore, in [27] automated model identification is presented that consists of finding the best model structure for each building at hand. However, while designing the herein presented method both publications were not yet available. One problem during identification are disturbances that are not marked or identifiable in the training data set. In general, disturbances are all auxiliary heat sources that affect the thermal behavior of a building and there are plenty of them such as stoves, computers, fireplaces. Another issue can be the SH-power measurement setup of a HVAC-system. Usually its purpose is billing. Therefore, only the total power is measured that may comprise circulation and DHW besides SH-power. However, for accurate identification and prediction the SH-power needs to be isolated. If it is not readily available, load disaggregation is required. Since this is not the focus of this paper, refer to existing literature such as [28]. Initially, the method suggested in [29] to minimize disturbances of occupants by performing the identification on a step response, i.e. \u201cactive\u201d excitation during night seemed appropriate. However, performing such an identification has three major disadvantages. 1. it misses the influence of solar radiation that is important [30], 2. it compromises DSM capability, and 3. it is likely to compromise occupants\u2019 comfort. The latter two disadvantages justified the decision to reject likewise the pseudo random binary sequence method as used in [13,31]. The extension of data sets over daytime to cover the missing solar radiation influence reduced the prediction accuracy of models due to daytime disturbances. Furthermore, avoiding an \u201cactive\u201d excitation, the data set did not sufficiently contain transients to be able to identify the thermal mass of buildings. Luckily, transients in case of DSM are common. However, this means that load reductions need to be performed on buildings before they are well identified. Therefore, continuous learning is required. In [32], a method is presented that allows it by using multiple sets of model parameters depending of prediction performance. It has been adopted in the presented method. However, poor performance of prediction was observed on real data sets, despite the use of multiple models. Therefore, a novel method of identification has been developed that relies on consecutive optimization steps. 2.3 Planning configurable and extendable load reductions It is essential for optimal peak demand reduction that the load profile is accurately predicted [2] underlining the importance of accurate system identification. The extent to which models are configurable and plannable differs, depending on whether pre-loading strategies are employed. Pre-loading strategies have been described in particular in [2,14,30] for cooling applications and are categorized as so called passive strategies as presented in [30]. However, these publications do not provide an quantitative expression on the dependency between pre-loading and load reduction. Also the configuration of load reductions in form of an expression of a relative reduction in power to nominal system operation has not been found in literature. For a good overview of the kind of constraints that are common refer to [33]. 2.4 Robust control with limited computational power Good reviews of control of HVAC-systems can be found in [8,10]. They have allowed to determine which benchmark in terms of controllers to use to evaluate the performance of the herein presented methodology. One of the major research progress in MPC has been achieved by the OptiControl project (presented in [34\u201336] among others) on which the herein presented methodology relies. These publications describe the control of blinds and mechanical ventilation additional to the heating system. However, in practice there are following issues: only few buildings have actuated blinds or mechanical ventilation, and many different technologies exist. In order to provide a economically competitive offer, this kind of actuators were neglected. Furthermore, this research project does not provide an analysis of computational load albeit computational considerations were driving certain decisions. In [37] an analysis of the computational load is presented relative to a sparse or dense formulation of the optimization problem. The dense formulation can be achieved by a method coined \u201cstate-condensing\u201d. One finding of this publication is that a dense formulation considerably reduces the computational load. Hence, it was adopted in the presented method. In the same publication, the state vector comprises a temperature for every single zone of a building while only one actuator controls the heat provided to the building. In practice, considering multiple buildings the number of zones is not constant and not all of them may be equipped with sensors. Hence, a unique formulation for every building would be required. Due to the ambition to avoid such complexities, the herein presented study seeks to establish a state-space representation common to multiple buildings, i.e. to transform the Multiple Input Single Output (MISO)-control problem to a Single Input Single Output (SISO) one. The publication in [38] formulates an interesting cost function which considers among other parameters the deviation to a nominal comfort definition PMV (defined in [39]). This deviation is not respected in times where the building is vacant. Despite the attractivity of this formulation is was discarded due to the difficulty to predict occupancy in a MFH and due to the foreseen setup in which only the power injected in the SH-circuit is controlled. In [40,41], formulations of MPC are presented in which inhabitants influence the outcome of the controller by providing feedback. This is promising, but cannot be applied if a feedback communication channel is missing and if the control can only influence a building\u2019s temperature as a whole. Challenging seems also to mitigate the expectable heterogeneity in occupants\u2019 thermal comfort expectations. 3 Methodology The adopted methodology for the development of MPC enabling DSM is to organize it into several standalone services. The evaluation can thus focus on independent services. In Fig. 1 the dependencies among the services are shown. In the following, the main four services will be presented in detail. They have been implemented in Python 3. It is followed by a description of the simulation environment used for evaluation of the method by comparison to conventional reactive controllers. The dynamic simulations use a multi-zoned building model and are based on the Ptolemy II environment [42]. This environment has also been used to demonstrate the capabilities of DSM. 3.1 Pre-processing The pre-processing of raw data is a crucial step for multiple functional bricks of MPC. Validation of all sensor data is required to assure correct data processing and control. A so-called \u201coutdoor temperature processor\u201d assures accuracy in outdoor temperature. The accuracy of outdoor temperature measurement of a climate compensated conditioning system is affected if the sensor is wrongly placed or if it is insufficiently shielded against solar radiation to name only the most common disturbances. Sensor outages or outliers are as well common. These disturbances are mitigated by filtering multiple sensors from various systems in the same geographic area. In the case of an unknown number both of zones in a building and of climate sensors to monitor them, the goal is a state-space representation common to all buildings. Therefore, the developed \u201cindoor temperature processor\u201d fuses signals of a variable amount of sensors to one representative signal. Several challenges exist such as: \u2022 Sensor outages \u2013permanent or intermittent\u2013 can occur in particular if wireless, battery powered sensors are used. \u2022 The temperature distribution in a building is rarely uniform and affected by all sorts of voluntary and involuntary disturbances such as solar radiation, occupancy, ventilation, aeration, wind, and auxiliary heat sources. For instance, in case of aeration, an inhabitant consciously opens up a window. Due to the voluntary nature of this action it shall not affect the climate in other apartments. Approaches as gating, median, or mean filtering or a combination of these give unsatisfactory results since they do not prevent jumps and are affected by voluntary actions. Jumps are rather detrimental to identification and control. In order to overcome these disadvantages, the developed indoor temperature processor performs the following: 1. Outliers are mitigated with an outlier robust Kalman filter for every climate sensor. The filter applies Variational Bayes fixed-point iterations as described in [43]. The system is described as a two-node temperature model. Furthermore, an anomaly detector based on a CUMSUM test is used as described in [44]. The data set is marked with the detected anomalies which has the benefit that they can be rejected during the identification process. 2. In case of a sensor dropout, a so called fader reconstructs values in the usual update time intervals of the failing sensor. The reconstruction continues either until the sensor starts producing again measurements or until the reconstructed values converge to the output, i.e. the representative temperature, of the previous time step. This function helps to assure smooth transitions in case of dropouts. 3. A triangular window fuses all sensor signals to cope with voluntary outliers. 4. An infinite impulse response low pass filter assures global smoothness of the fused signal. One additional function the pre-processing must assure is to mark the system operation type. If for instance transients are caused by DSM-events, the identification is greatly improved if these periods are marked. 3.2 Identification The method to select the model structure was try and error using models presented in [23]. The model TiThTeAe has been selected 4 4 Note that e for envelope in the cited publication has been replaced by w for wall in this publication. as presented in Fig. 2 since it provided the best prediction accuracy among all buildings. This model decouples solar absorption of solar radiation on outer wall and direct transmitted power of solar radiation on indoor climate (see [22]). Thereby, the wall temperature T w is not measured, but represents a so-called hidden state. Furthermore, a separate capacitance C h for the SH-circuit allows to model the delay between heat injection of central heat source and its dissipation into rooms by the convector fluid. Note that the conductance G is the inverse of the resistance R. The model can be formalized in state-space representation as follows: (1) T ̇ w T ̇ h T ̇ i = - G aw + G ih C w 0 G ih C w 0 - G ih C h G ih C h G iw C i G ih C i - G iw + G ih C i T w T h T i + G aw C w 0 A w C w 0 1 C h 0 0 0 A i C i T a P SH P sol + w The universality of a parameter set of a model with a fixed structure has been analyzed by following method. With model structure \u2013TiThTeAe\u2013, model parameters are identified over one specific week, then applied to predict system behavior over a data set of 40 weeks, i.e. a heating season, and finally the error is evaluated for each week. This is repeated by identifying the model parameters on each individual week of the data set. The results of this analysis are presented exemplary in Fig. 3 . On the abscissa is the week used for identifying the model parameters and on the ordinate the respective weeks on which the learned model has been applied and the error has been evaluated. This analysis allowed to conclude that a single parameter set is not sufficient to permanently and accurately predict the behavior of a system. Therefore, a continuous identification process is presented that reiterates the identification in order to permanently assure good prediction performance. Continuous identification is necessary to assure that a building always has an accurate building model. The excitation of the system is important to achieve good results in the identification. It must contain transients to properly estimate the parameters. The reason is that in the stationary case, i.e. X ̇ = 0 the capacitances becomes not observable and cannot be correctly determined. Therefore, the identification is performed in following three steps: 1. Handling anomalies: In case of a important ones, the data is divided into several data sets excluding the incomplete or disturbed periods. For each sliced data set an individual initial state is determined. The assumption is made that these states are constant over the whole identification process. 2. Analyzing transients: Only data sets with periods with high dynamics are considered during this step of parameter fitting. If values of parameters of previous identifications are available, the optimization is initialized with these. All parameters are allowed to vary. 3. Tuning resistances: The whole period is considered for the parameter fitting. All parameters can vary except C i , C h , G ih . The reason is that thermal capacitances are not observable in steady state. C w is treated differently because the state of the wall is hidden, i.e. the temperature is not observable. The parameters are fitted by minimizing the error between the measured and the predicted indoor and SH-temperature. The tool lmfit 5 5 https://lmfit.github.io/lmfit-py/, last accessed 16th October 2022. provides the possibility to partially fix certain parameters and has been used for the identification. The predicted temperature can be calculated based on an assumption on the initial state when it comes to the hidden state T w . It is determined by an initial error minimization procedure. Starting from the initial state and the known inputs, i. e. outdoor temperature, SH-power and solar irradiation, the future temperatures can be predicted. The model manager triggers the execution of the identification routine and provides the necessary data set. Models are continuously learned in regular time intervals or on demand. The logic of the required model manager is presented in Fig. 4 . It illustrates a survival of the fittest logic, in which a finite number of parameter sets is updated according to a rank. The worst parameter set (several criteria exist such as least used or oldest) is discarded or archived whenever a new parameter set is produced. This limits not only the memory need, but reduces also the computational load for the selection of the parameter set best suited for the upcoming forecast. The parameter set is selected that has the lowest root mean square error between past measurements and predicted ones over the last n-days. The unknown building state is calculated by running several Kalman Filters in parallel with different model parameters. At each time step, the calculated building state is stored in a database. The building state is updated using the actual measurements and the actual input values. Furthermore, the building state is needed for planning the power sequence. 3.3 Planning The planning is performed on a building level. The optimal SH-power under consideration of forecast data is obtained by optimization using Quadratic Programming (QP), which is solved with the standard solver cvxopt. 6 6 https://cvxopt.org, last accessed 16th October 2022. The optimization is performed twice. The first one aims at establishing a nominal, i.e. reference power sequence that only is considering the weather forecast and the desired nominal operation of the HVAC-system. The second one additionally takes into account DSM-events thus adds constraints relative to the nominal plan that has been established before. These constraints define a DSM-event consisting of following three, consecutive phases: 1. Pre-loading (optional) 2. Load reduction 3. Post-loading Pre-loading is optional. Its purpose is to extend the load reduction in terms of power or duration. The standard QP for optimization is defined as 7 7 Note that the vector x in Eq. 2 shall not be confused with the state in Eq. 6 and following : (2) min x 0.5 x T Qx + q T x where x is the solution, which should be calculated respecting the equality constraint: (3) Ax = a and inequality constraint: (4) Bx ⩽ b . The determination of the SH-power sequence for each time step j respecting DSM-events is based on the minimization of following cost function: (5) Φ = ∑ j 0.5 ( ( T i , j - T \u203e i , j ) T W y ( T i , j - T \u203e i , j ) + ( ϕ SH , j - ϕ ¯ SH , j ) T W u ( ϕ SH , j - ϕ ¯ SH , j ) + ( Δ SH , j ) T W d ( Δ SH , j ) ) where variables are defined as follows: \u2022 T i , j the indoor temperature \u2022 T \u203e i , j is the desired indoor temperature \u2022 ϕ SH , j the control sequence, which should be determined \u2022 ϕ ¯ SH , j reference input power \u2022 Δ SH , j is the difference of two consecutive power values \u2022 W y weighting matrix for the indoor temperature \u2022 W u weighting matrix for the SH-power \u2022 W d weighting matrix for the smoothness The first term is responsible that indoor set temperature is reached. The second term is responsible that the SH-power considers the reference input power. The third term is responsible that the changes in SH-power, i.e. power drift rates are limited. It is worth noting that the second and/or the third summand can be neglected. In particular, the deviation from reference power can be omitted if no DSM-event is planned. The optimization function Φ is re-written in the form of a QP-problem. First the building model is written in state space, then a so called state condensing method is applied, which will be explained in the next section. The idea of state condensing is that the state sequence, i. e. states for consecutive time steps, can be written in a vector\u2013matrix convention, where the state at time step j + 1 only depends on the initial state at time step 0 and the inputs from 0 , \u2026 j . In [45] a more detailed explanation can be found. The system equation, which describes the change in state from one time step to the next is given by (6) x ̇ j + 1 = Ax j + Bu j + Nd j with the state x = [ T i , T h , T w ] T , the unknown control input u = ϕ SH , and the known input d = [ T 0 , ϕ solar ] . The mapping of the state to the indoor and SH-temperature is defined by the measurement equation: (7) y j = Cx j The sequence for a temperature \u2013e.g. the indoor temperature T i , j \u2013 depends on the unknown control input u j = ϕ SH , j . The system equation can be rewritten in matrix\u2013vector convention in such a way, that it does not depend on the sequence T i , j anymore. This is achieved by writing the system equation recursively, where x 0 is the known initial state from the observer. At the first time step, one gets: (8) x ̇ 1 = Ax 0 + Bu 0 + Md 0 For the second time step, the solution of the first step is plugged in and results in: (9) x ̇ 2 = AAx 0 + ABu 0 + AMd 0 + Bu 1 + Md 1 For the time horizon N, one gets: (10) x ̇ N = A N x 0 + A N - 1 Bu 0 + A N - 1 Md 0 + A N - 2 Bu 1 + A N - 2 Md 1 + \u2026 + Bu N - 1 + Md N - 1 which can be simplified to: (11) x ̇ i = A i x 0 + ∑ j = 1 i A i - j Bu j - 1 + ∑ j = 1 i A i - j Md j - 1 The indoor temperature sequence can be calculated according to the matrix C i = [ 1 , 0 , 0 ] by (12) T i , i = C i A i x 0 + C i ∑ j = 1 i A i - j Bu j - 1 + C i ∑ j = 1 i A i - j Md j - 1 and the SH-temperature sequence according to the matrix C SH = [ 0 , 1 , 0 ] by (13) T h , i = C SH A i x 0 + C SH ∑ j = 1 i A i - j Bu j - 1 + C SH ∑ j = 1 i A i - j Md j - 1 . The sequence of the indoor temperature is expressed in vector\u2013matrix convention as follows: (14) T i = F i b + H i u where b consist of the initial state and the forecast data for outdoor temperature and solar irradiation and u the unknown control sequence (SH-power). For the SH-temperature we get (15) T h = F h b + H h u . The equations for the indoor and SH-temperature sequence can now be used for the optimization function and for defining constraints. 3.3.1 Optimization function indoor temperature First the deviation between the indoor temperature and the set temperature is defined as (16) e = T i - T \u203e i . The equation can be written in such a way that it depends on the control sequence u as (17) e = F ∗ b ∗ + H i u , where F ∗ = [ F i , - I ] and b ∗ = [ b T , T \u203e i T ] T . For the minimization function Φ with respect to the indoor temperature we get (18) 0.5 e T W y e = 0.5 b ∗ T F ∗ T W y F ∗ b ∗ + b ∗ T F ∗ T W y H i u + 0.5 u T H i T W y H i u where the term, which does not depend on u can be omitted. For the QP-problem with respect to the indoor temperature we get (19) Q = H i T W y H i , (20) q T = b ∗ T F ∗ T W y H i . 3.3.2 Optimization function SH-power The difference between the control sequence u and the reference control sequence u ¯ is defined as (21) e = u - u . ¯ For the minimization function Φ with respect to the SH-power we get (22) 0.5 e T W u e = 0.5 u ¯ T W u u ¯ + ( - u ¯ W u ) u + 0.5 u T W u u where in the QP-problem we get (23) Q = W u and (24) q T = - u ¯ W u . 3.3.3 Optimization function smoothness SH-power The difference quotient of the power between two consecutive time step Δ SH can be written such that one term depends on the future SH-power and the second term of the last applied power: (25) Δ SH = 1 0 0 \u2026 0 - 1 1 0 \u2026 0 0 - 1 1 \u2026 0 0 \u2026 0 - 1 1 u - u - 1 0 \u2026 0 = Δ u + v For the minimization function Φ and the difference quotient of the power we get (26) 0.5 Δ SH T W d Δ SH = 0.5 v T W d v + vW d Δ u + 0.5 u T Δ T W d Δ u where in QP optimization we get (27) Q = Δ T W d Δ and (28) q T = vW d Δ . The resulting optimization function is then written as QP-problem (29) Q = H i T W y H i + W u + Δ T W d Δ and (30) q T = b ∗ T F ∗ T W y H i - u ¯ W u + vW d Δ . 3.3.4 Constraints The constraints for the optimization problem define either the nominal operation of a HVAC-system or the one including DSM-events. The constraints for nominal operation are formulated with respect to temperature, power, or drift rates. These are altered during DSM-events that are presented in Section 3.3.5. The constraints have to be formulated relative to the unknown control input. This formulation is similar to the derivation of the optimization functions. In the following, inequality constraints are exemplary presented. The constraint on temperature is defined as inequality with regard to a maximum temperature that may apply to indoor or the SH-temperature: (31) y ⩽ T max For y the result of the state condensing routine can be plugged in, which results in (32) Fb + Hu ⩽ T max . The resulting constraint for QP-problem is then (33) Hu ⩽ T max - Fb . A minimum temperature is defined as (34) y ⩾ T min . Similar to the maximum constraint, the result of the state condensing routine is plugged in (35) - Fb - Hu ⩽ - T min and formulated to the constraint for QP-problem (36) - Hu ⩽ - T min + Fb . The constraint on the SH-power can simply be defined with regard to a maximum power u max or minimum u min as (37) u ⩽ u max and for the minimum as (38) - u ⩽ - u min . The constraint on drift rate δ in charge or discharge situation depends on the different quotient Δ SH dt like in the optimization function and the constraint is defined as (39) Δ SH dt ⩽ δ . Multiplying by the sampling time dt results in (40) Δ SH ⩽ δ dt . The vector Δ SH is split into Δ u + v the unknown controller input u and the last applied SH-power as (41) Δ u + v ⩽ δ dt . The constraint for the QP-problem is then given by (42) Δ u ⩽ δ dt - v . 3.3.5 Constraints of a DSM-event The implemented forecast solver provides several methods to define a DSM-event. These methods are configurable by a set of parameters. A selection of these parameters is graphically represented in Fig. 5 and explained in accordance to the three phases of such an event in the following. Pre-loading is defined with a maximum constraint on the indoor temperature. It shall prevent that the indoor temperature is greater than the sum of set temperature and an offset relative to the pre-loading phase. For the SH-power a maximum value is set. The overshoot α pre in SH-power is limited by this maximum that is expressed relative to the nominal power ϕ ¯ . Furthermore, a minimum for the SH-power is set to avoid that the power is smaller than the nominal one. The box constraint can be expressed as follows: (43) ϕ ¯ SH , j ⩽ ϕ SH , j ⩽ ( 1 + α pre ) ϕ ¯ SH , j Load reduction is defined with a constraint on maximum value of SH-power relative to the nominal one α red . The maximum is smaller than the nominal power to reduce or cut SH-power during the load reduction phase. The box constraint can be expressed as follows: (44) 0 ⩽ ϕ SH , j ⩽ ( 1 - α red ) ϕ ¯ SH , j Furthermore, the minimum value for the indoor temperature is set according to temperature offset relative to this phase. Another important parameter to prevent cold draught from windows is the minimal temperature of the SH-circuit T min , SH . Post-loading is defined with a constraint on maximum overshoot α post of SH-power relative to the nominal one. Furthermore, a minimum value for the SH-power is set to avoid that the power is smaller than the nominal one. It can be expressed as follows: (45) ϕ ¯ SH , j ⩽ ϕ SH , j ⩽ ( 1 + α post ) ϕ ¯ SH , j A summary of all planning parameters is provided in Table 1 . They allow the configuration of DSM-events. It is worth noting, that not all choices in parameter values may result in a feasible event. Appropriate detection of infeasibilities is beneficial to warn about inaccurate DSM predictions. 3.4 Control The primary requirement of any controller is robustness. Since communication is required to execute DSM-events on multiple distributed agents, special attention must be given to communication outages. If they occur, a HVAC-system must still assure thermal conditioning. Therefore, the objectives for the HVAC-system differ whether a DSM-plan is available or not and transitions must be smooth. The two cases are: 1. In absence of a DSM-plan the controller must robustly control a set temperature that may be either static or dynamic. 2. If a DSM-plan exists the controller must assure its accurate execution thus harness indoor and SH-temperature and SH-power deviations. The overall architecture thus foresees two levels of control as presented in Fig. 6 : high and low-level. The high-level control uses the result of the planning service: the predicted trajectory of the supply temperature of the SH-circuit as set temperature T SH , set ( t ) . Presuming the inverse of the heat curve 8 8 Common name of function that describes the relationship between outdoor temperature and required supply temperature to hold a given indoor set temperature in weather-compensated HVAC\u2013controllers. is known, the supply temperature is transformed to the correspondent outdoor temperature T outdoor , emu , planned . This so called emulated outdoor temperature is then fed to the HVAC\u2013controller instead of the measured one in order to achieve the desired supply temperature at a given time step. The assumption is that the plan is correct thus respecting the supply temperature will result in the predicted indoor temperature. However, deviations occur due to inaccuracies of a building model or other disturbances. They are corrected by the lower-level controller. The low-level control verifies that the planned indoor temperature is reached. Therefore, a Proportional Integral Derivative (PID) controller is employed. It is worth noting that if the low-level controller takes as input the constant set indoor temperature instead of the dynamic indoor temperature trajectory, no satisfactory control action could be achieved since DSM-events controlled by the high-level controller would be counteracted by the low-level one. Since forecasts are limited in time, temporal overlap of plans as presented in Fig. 7 improves robustness. The transitions from one plan to the next must be smooth, otherwise HVAC-systems become unstable. Therefore, special care is given at the initialization of the state, each time a new plan becomes operational. 3.5 Method of evaluation based on dynamic simulations The evaluation of the method presented in previous subsections is based on simulations. They have the advantage that longer periods can be tested in time agnostic fashion and that results can be reproduced [18]. Therefore, a MFH has been modeled which sources thermal energy through a so called substation. The infrastructure is presented in Fig. 8 . The building employed for simulation contains several zones (4 zones on 5 floors) that are modeled with 3 lumped mass models for outer wall, interior, and SH-system (Eqs. (46)\u2013(48)) similar to the model presented in Section 3.2. A conventional hydronic radiator model according to EN442 has been used [46]. Every zone has an orientation β that determines how much it is affected by solar radiation in relation to the time t. The direct losses from interior to ambient climate defined by resistance R ai in Eq. 50 have been intentionally added to cause a difference to the model used in the presented method for MPC. It is presumed a fair distribution of total SH-power P SH ( t ) among all zones (see Eq. 48). Only the temperature of a randomly selected subset of all zones are processed as input to the controller (8 out of N = 20). The governing equations of zone j are: (46) C i dT i , j dt = P rad ( t ) + A i P sol ( β j , t ) - P loss ( t ) (47) C w dT w , j dt = 1 R wi ( T i , j - T w , j ) + 1 R wa ( T a - T w , j ) + A w P sol ( β j , t ) (48) C h dT h , j dt = P SH ( t ) N + 1 R ih ( T i , j - T h , j ) (49) P rad ( t ) = 1 R ih ( T h , j - T i , j ) (50) P loss ( t ) = 1 R ai ( T i , j - T a ) + 1 R wi ( T i , j - T w , j ) Furthermore, a substation is presumed in which a PID controller assures that the set supply temperature into the SH-circuit is met by adjusting a valve opening on the primary side of the Heat Exchanger (HX). The model of the plate HX is dynamic. A bang-bang controller takes as input signal the outdoor temperature for determining the activation of the SH-circulation pump with constant flow. The simulations are performed with real weather observations for Stockholm 9 9 provided by SMHI for Observatoriekullen station https://opendata.smhi.se/apidocs/metobs/data.html. . The method to evaluate the herein presented predictive control method consisted of a comparison with conventional open-loop and closed-loop controllers, both being reactive. The supply temperature setpoint of former is determined through the heat curve. Latter controller determines the supply temperature setpoint based on the deviation between observed indoor temperature and its setpoint. The controllers\u2019 evaluation consisted in analyzing how good they were capable to hold a given indoor temperature setpoint under the presence of solar radiation and outdoor temperature disturbances. No DSM-events were planned to avoid to have to evaluate transients. Aspects that are considered in the evaluation are the total energy E, the average representative temperature T rep based on the randomly selected subset of zones and its standard deviation σ , the average temperature of all zones in the building T avg and its standard deviation, and finally, the offset error e between the indoor temperature setpoint T set and these averages, e set , rep and e set , avg , respectively. 4 Results The results are twofold. Performance evaluations are presented in the first section while the DSM capability is showcased in the second one. 4.1 Performance evaluation The results of the simulation runs using the method presented in Section 3.5 based on real climatic conditions from 28/10/2018 \u2013 4/11/2018 in Stockholm are presented in Table 2 . In the following, the results will be presented according to specific parameters. First, the results with regard to the error e set , rep show that the method based on MPC has almost no error while conventional controllers have an error of ∼ -0.4 K. However, considering the temperature of all zones the error e set , avg is about double as high for MPC. In general, the indoor temperature is below the desired set temperature with conventional controllers. Secondly, the standard deviations of the representative temperature show that open-loop control is worst in terms of holding the indoor temperature constant. Closing the control loop improves the stability by about a factor 2. Employing MPC further improves the stability by about a factor 6. However, if one considers the average temperature of all zones, the improvement in standard deviation achievable with MPC compared to closed loop control is smaller \u2013 about a factor 3. In comparison, the improvement with regard of open-loop control remains unchanged around a factor 6. In terms of energy consumption, comparing configurations with the same set temperature T set (1, 2, and 4), MPC configuration 4 has around 2.8% more energy demand. However, conventional controllers fail to reach in average the set temperature. Therefore, the performance evaluation has been extended with configuration 3 and 5 with reduced set temperature. Configuration 3 has a energy demand comparable to conventional controllers while configuration 5 has the lowest one of all configurations (around 4% less). A comparison of the worst and best configuration is presented in Fig. 11 . A visual inspection of the indoor temperature confirms the results presented in Table 2. The SH-power fluctuates more in Fig. 11a than in Fig. 11b. 4.2 Showcase of DSM-events The planning of DSM-events is exemplary represented in Fig. 9 . The consequences are represented relative to the nominal plan: In the upper graph the deviation in terms of SH and indoor temperature is shown while in the lower the deviation in terms of SH-power. This kind of plan has been used in the dynamic simulation environments that allowed an evaluation of the consequence of DSM-events and its parameters. As exemplary represented in Fig. 10 the infrastructure can handle to switch from MPC to PID control. 5 Discussion and future developments The presented method is tested on a building model with multiple zones that are all different in terms of solar radiation influence thus indoor temperature. The question is which comfort can be achieved with the different controllers. Presuming that constancy in temperature assures thermal comfort of inhabitants \u2013 which is definitely an arguable statement, see e.g. [47] \u2013 the set temperature for the MPC\u2013controller is adjusted. In configuration 3, it is set to the average representative temperature of the PID controller. In configuration 5, the difference in standard deviation of the representative temperature is additionally subtracted. The reason is that the occupant temporally endures temperatures around or even below the set temperature of configuration 5 if the climate would be controlled by PID control (configuration 3). One can graphically verify this statement in Fig. 11. The remaining question is whether this produces comparable comfort. MPC undeniably improves the capability to achieve and hold a dynamic set temperature \u2013 even in case the infrastructure is not capable of producing an optimal plan. The energy demand caused by the presented method is tendentially better than conventional controllers in particular if one considers to reduce the set temperature according to the improved stability presented by the new method ( ∼ 4%). One needs to consider that the solar radiation in the evaluation data set is not important ( < 300 W/m2) for October 2018 in Stockholm thus the advantages of predictive control may be smaller. Nevertheless, MPC seems to be the best suited controller for dynamic indoor conditioning among the considered methods. The required adaptability of building models has been achieved through parameter variation of a model with fixed structure. Undeniable seems the need for transients in training data sets to accurately identify the thermal mass which contradicts statements found in [31]. Future studies shall investigate the room for improvement with models with variable model structure in relation to computational cost and complexity. The presented model manager selects a building model based on the error between a model\u2019s prediction and the actual measured state. Establishing a measure of distance among models would enable further research on the dependency between season, building type, and identified building model. This measure would have two benefits: 1. an alternate selection criterion among models for the same building, 2. achieve good control and planning performance even for a building with no model by applying one of a similar building. The strength of the presented method is that it enables an energy utility company to plan DSM-events with higher certainty in particular on the duration and power of the post-loading phase. A configurable duration of a post-loading phase allows to more securely plan consecutive load reductions in particular within the same day. Furthermore, the presented method allows to increase a load reduction by pre-loading. Another major finding is the capability to express constraints relative to the nominal behavior of a building. Further work is needed to test the constraint to limit the reduction of SH-temperature, i.e. to prevent cold draught, in case of load reductions. In particular, the temperature limit for a radiator below a window needs to be clarified. The influence of the presented parameters and constraints on planning and control needs to be further investigated. What remains uncertain is the response of the inhabitants in terms of perceived QoS. More research should be undergone to ensure a satisfactory indoor temperature distribution if only a limited number of sensors are available. One solution is the monitoring of the inhabitants\u2019 satisfaction that could be achieved for instance by offering them a feedback channel. However, if the inhabitants have diverging thermal comfort expectations a mitigation only seems possible through integration of additional control organs such as radiator thermostats to offer control on room-level. A remaining question is whether such MPC on room-level can achieve satisfactory results without taking into consideration the thermal transfers of adjacent interiors. This simplification would have the benefit to reduce the complexity of the required estimation method. Future research shall apply the presented MPC method in real buildings instead of simulations to expose the method to real disturbances. It needs to be clarified if the higher dynamic in SH-power causes issues. It is likely that smoother transitions between one and another plan (see Fig. 11a) are required. The question is how to achieve this without increasing computational load. Even if this paper has focused on grey-box model, black-box models may have good prospects in the future. In case of interest, refer to review [48] to get an overview. Special attention should also be given in the future to statistical approaches using reinforcement learning such as presented in [49,50]. In [51], static and dynamic deployment of model learning is presented. Respecting the findings of this paper that multiple models are needed to permanently assure high prediction accuracy, it remains to clarify if the reinforcement strategy outperforms the survival of the fittest strategy presented in this paper. 6 Conclusion The major finding of this paper is a method that enables predictive control, offers the capability of performing load reductions while harnessing the post-loading phase, optionally extending them with a pre-loading one. This has been possible through the definition of novel constraints including ones relative to nominal system behavior. Furthermore, the novelty of the presented method consists in the reduced frequency of plan elaboration though optimization \u2013 only once per hour instead of at every control step. This allows to considerably reduce the computational load. Therefore, it is particularly suited for a supervisory and centralized control infrastructure simultaneously handling the conditioning of several thousands of buildings. This study shows that prediction performance is improved by using multiple instead of a single model for a building. A model manager is presented to orchestrate the identification of models and their selection for prediction. Considering data sets acquired on real buildings, prediction performance is poor if the fitting procedure omits to initially filter the data set and simultaneously adjusts all parameters. As a consequence, this study presents a novel identification routine based on multiple consecutive steps aiming to improve prediction performance. Future studies shall investigate the dependency between the perceived QoS, i.e. thermal comfort, and dynamic indoor conditioning. Furthermore, even if dynamic conditioning is enabled by the presented method, personalized trajectories need to be investigated further in simulations and in real buildings, preferably on room-level. In summary, the presented predictive method enables a more accurate control of indoor temperature trajectories than reactive controllers. It enables DSM and to adapt to inhabitants\u2019 dynamic thermal preferences and occupancy. Declaration of Competing Interest The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgment The authors are most grateful for the support of the data-science service provider Knowtion GmbH, Karlsruhe, Germany and in particular to Dr. Frederik Beutler who has accompanied this development with his expertise. References [1] G.M. Masters Renewable and efficient electric power systems 2013 John Wiley & Sons G.M. Masters, Renewable and efficient electric power systems, John Wiley & Sons, 2013. [2] Y. Sun S. Wang F. Xiao D. Gao Peak load shifting control using different cold thermal energy storage facilities in commercial buildings: a review Energy Convers. Manage. 71 2013 101 114 Y. Sun, S. Wang, F. Xiao, D. Gao, Peak load shifting control using different cold thermal energy storage facilities in commercial buildings: a review, Energy conversion and management 71 (2013) 101\u2013114. [3] M. Veselý W. Zeiler Personalized conditioning and its impact on thermal comfort and energy performance\u2013A review Renew. Sustain. Energy Rev. 34 2014 401 408 M. Veselý, W. Zeiler, Personalized conditioning and its impact on thermal comfort and energy performance\u2013A review, Renewable and Sustainable Energy Reviews 34 (2014) 401\u2013408. [4] M. Morari J.H. Lee Model predictive control: past, present and future Comput. Chem. Eng. 23 4\u20135 1999 667 682 M. Morari, J.H. Lee, Model predictive control: past, present and future, Computers & Chemical Engineering 23 (4-5) (1999) 667\u2013682. [5] J.A. Myhren S. Holmberg Flow patterns and thermal comfort in a room with panel, floor and wall heating Energy Build. 40 4 2008 524 536 J.A. Myhren, S. Holmberg, Flow patterns and thermal comfort in a room with panel, floor and wall heating, Energy and buildings 40 (4) (2008) 524\u2013536. [6] F. Wernstedt Multi-agent systems for district heating management 2003 Blekinge Institute of Technology Ph.D. thesis, F. Wernstedt, Multi-agent systems for district heating management, Ph.D. thesis, Blekinge Institute of Technology (2003). [7] A. Foucquier S. Robert F. Suard L. Stéphan A. Jay State of the art in building modelling and energy performances prediction: A review Renew. Sustain. Energy Rev. 23 Supplement C 2013 272 288 A. Foucquier, S. Robert, F. Suard, L. Stéphan, A. Jay, State of the art in building modelling and energy performances prediction: A review, Renewable and Sustainable Energy Reviews 23 (Supplement C) (2013) 272 \u2013 288. URL:http://www.sciencedirect.com/science/article/pii/ S1364032113001536 [8] A. Afram F. Janabi-Sharifi Theory and applications of HVAC control systems\u2013A review of model predictive control MPC Build. Environ. 72 2014 343 355 A. Afram, F. Janabi-Sharifi, Theory and applications of HVAC control systems\u2013A review of model predictive control (MPC), Building and Environment 72 (2014) 343\u2013355. [9] G. Serale M. Fiorentini A. Capozzoli D. Bernardini A. Bemporad Model Predictive Control (MPC) for enhancing building and HVAC system energy efficiency: Problem formulation, applications and opportunities Energies 11 3 2018 631 G. Serale, M. Fiorentini, A. Capozzoli, D. Bernardini, A. Bemporad, Model predictive control (mpc) for enhancing building and hvac system energy efficiency: Problem formulation, applications and opportunities, Energies 11 (3) (2018) 631. [10] M. Gholamzadehmir C. Del Pero S. Buffa R. Fedrizzi N. Aste Adaptive-predictive control strategy for HVAC systems in smart buildings \u2013 A review Sustain. Cities Soc. 63 2020 102480 M. Gholamzadehmir, C. Del Pero, S. Buffa, R. Fedrizzi, N. Aste, Adaptive-predictive control strategy for HVAC systems in smart buildings \u2013 A review, Sustainable Cities and Society 63 (2020) 102480. URL:https://www.sciencedirect.com/science/article/pii/S2210670720307009 [11] D. Mariano-Hernández L. Hernández-Callejo A. Zorita-Lamadrid O. Duque-Pérez F. Santos García A review of strategies for building energy management system: Model predictive control, demand side management, optimization, and fault detect & diagnosis J. Build. Eng. 33 2021 101692 D. Mariano-Hernández, L. Hernández-Callejo, A. Zorita-Lamadrid, O. Duque-Pérez, F. Santos García, A review of strategies for building energy management system: Model predictive control, demand side management, optimization, and fault detect & diagnosis, Journal of Building Engineering 33 (2021) 101692. URL:https://www.sciencedirect.com/science/article/pii/S2352710220310627 [12] G. Bianchini M. Casini A. Vicino D. Zarrilli Demand-response in building heating systems: A model predictive control approach Appl. Energy 168 2016 159 170 G. Bianchini, M. Casini, A. Vicino, D. Zarrilli, Demand-response in building heating systems: A model predictive control approach, Applied Energy 168 (2016) 159\u2013170. [13] J. Ma J. Qin T. Salsbury P. Xu Demand reduction in building energy systems based on economic model predictive control Chem. Eng. Sci. 67 1 2012 92 100 J. Ma, J. Qin, T. Salsbury, P. Xu, Demand reduction in building energy systems based on economic model predictive control, Chemical Engineering Science 67 (1) (2012) 92\u2013100. [14] T. Péan R. Costa-Castelló J. Salom Price and carbon-based energy flexibility of residential heating and cooling loads using model predictive control Sustain. Cities Soc. 50 2019 101579 T. Péan, R. Costa-Castelló, J. Salom, Price and carbon-based energy flexibility of residential heating and cooling loads using model predictive control, Sustainable Cities and Society 50 (2019) 101579. URL:https://www.sciencedirect.com/science/article/pii/S2210670718325095 [15] M. Maasoumy A. Sangiovanni-Vincentelli Total and peak energy consumption minimization of building HVAC systems using model predictive control IEEE Design Test Comput. 29 4 2012 26 35 M. Maasoumy, A. Sangiovanni-Vincentelli, Total and peak energy consumption minimization of building hvac systems using model predictive control, IEEE Design & Test of Computers 29 (4) (2012) 26\u201335. [16] S. Goyal Advanced Controls for Intelligent Buildings 2021 CRC Press S. Goyal, Advanced Controls for Intelligent Buildings, CRC Press, 2021. [17] Y. Zong G.M. Böning R.M. Santos S. You J. Hu X. Han Challenges of implementing economic model predictive control strategy for buildings interacting with smart energy systems Appl. Therm. Eng. 114 2017 1476 1486 Y. Zong, G.M. Böning, R.M. Santos, S. You, J. Hu, X. Han, Challenges of implementing economic model predictive control strategy for buildings interacting with smart energy systems, Applied Thermal Engineering 114 (2017) 1476\u20131486. [18] J. Arroyo C. Manna F. Spiessens L. Helsen Reinforced model predictive control (RL-MPC) for building energy management Appl. Energy 309 2022 118346 J. Arroyo, C. Manna, F. Spiessens, L. Helsen, Reinforced model predictive control (RL-MPC) for building energy management, Applied Energy 309 (2022) 118346. [19] A. Berouine R. Ouladsine M. Bakhouya M. Essaaidi A predictive control approach for thermal energy management in buildings Energy Rep. 8 2022 9127 9141 A. Berouine, R. Ouladsine, M. Bakhouya, M. Essaaidi, A predictive control approach for thermal energy management in buildings, Energy Reports 8 (2022) 9127\u20139141. [20] S. Goy D. Finn Estimating demand response potential in building clusters Energy Proc. 78 2015 3391 3396 D. Finn, Estimating demand response potential in building clusters, Energy Procedia (2015). [21] P. Radecki B. Hencey Online Building Thermal Parameter Estimation via Unscented Kalman Filtering 2012 American Control Conference (ACC), IEEE 2012 3056 3062 P. Radecki, B. Hencey, Online Building Thermal Parameter Estimation via Unscented Kalman Filtering, in: 2012 american control conference (acc), IEEE, 2012, pp. 3056\u20133062. [22] H. Madsen J. Holst Estimation of continuous-time models for the heat dynamics of a building Energy Build. 22 1 1995 67 79 H. Madsen, J. Holst, Estimation of continuous-time models for the heat dynamics of a building, Energy and Buildings 22 (1) (1995) 67\u201379. [23] P. Bacher H. Madsen Identifying suitable models for the heat dynamics of buildings Energy Build. 43 7 2011 1511 1522 P. Bacher, H. Madsen, Identifying suitable models for the heat dynamics of buildings, Energy and Buildings 43 (7) (2011) 1511\u20131522. [24] R.E. Hedegaard S. Petersen Evaluation of grey-box model parameter estimates intended for thermal characterization of buildings Energy Proc 132 2017 982 987 R.E. Hedegaard, S. Petersen, Evaluation of grey-box model parameter estimates intended for thermal characterization of buildings, Energy Procedia 132 (2017) 982 \u2013 987, 11th Nordic Symposium on Building Physics, NSB2017, 11-14 June 2017, Trondheim, Norway. URL:http://www.sciencedirect.com/science/article/pii/S1876610217348397 [25] D. Blum K. Arendt L. Rivalin M. Piette M. Wetter C. Veje Practical factors of envelope model setup and their effects on the performance of model predictive control for building heating, ventilating, and air conditioning systems Appl. Energy 236 2019 410 425 D. Blum, K. Arendt, L. Rivalin, M. Piette, M. Wetter, C. Veje, Practical factors of envelope model setup and their effects on the performance of model predictive control for building heating, ventilating, and air conditioning systems, Applied Energy 236 (2019) 410\u2013425. [26] C.A. Thilker P. Bacher H.G. Bergsteinsson R.G. Junker D. Cali H. Madsen Non-linear grey-box modelling for heat dynamics of buildings Energy Build. 252 2021 111457 C.A. Thilker, P. Bacher, H.G. Bergsteinsson, R.G. Junker, D. Cali, H. Madsen, Non-linear grey-box modelling for heat dynamics of buildings, Energy and Buildings 252 (2021) 111457. [27] J. Leprince H. Madsen C. Miller J.P. Real K. Basu W. Zeiler Fifty shades of grey: Automated stochastic model identification of building heat dynamics Energy Build. 266 2022 112095 J. Leprince, H. Madsen, C. Miller, J.P. Real, K. Basu, W. Zeiler, et al., Fifty shades of grey: Automated stochastic model identification of building heat dynamics, Energy and Buildings (2022) 112095. [28] P. Bacher P.A. de Saint-Aubain L.E. Christiansen H. Madsen Non-parametric method for separating domestic hot water heating spikes and space heating Energy Build. 130 2016 107 112 P. Bacher, P.A. de Saint-Aubain, L.E. Christiansen, H. Madsen, Non-parametric method for separating domestic hot water heating spikes and space heating, Energy and Buildings 130 (2016) 107\u2013112. [29] F. Omar F. Omar S.T. Bushby A Self-learning Algorithm for Temperature Prediction in a Single Family Residence 2015 US Department of Commerce, National Institute of Standards and Technology F. Omar, F. Omar, S.T. Bushby, A Self-learning Algorithm for Temperature Prediction in a Single Family Residence, US Department of Commerce, National Institute of Standards and Technology, 2015. [30] X. Li J. Wen Review of building energy modeling for control and operation Renew. Sustain. Energy Rev. 37 2014 517 537 X. Li, J. Wen, Review of building energy modeling for control and operation, Renewable and Sustainable Energy Reviews 37 (2014) 517\u2013537. [31] M.D. Knudsen R.E. Hedegaard T.H. Pedersen S. Petersen System identification of thermal building models for demand response\u2013a practical approach Energy Proc. 122 2017 937 942 M.D. Knudsen, R.E. Hedegaard, T.H. Pedersen, S. Petersen, System identification of thermal building models for demand response\u2013a practical approach, Energy Procedia 122 (2017) 937\u2013942. [32] J. Ako L. Viitala Method for controlling heating in buildings 2016 World Intellectual Property Organization Tech. Rep. WO/2016/198745 J. Ako, L. Viitala, Method for controlling heating in buildings, Tech. Rep. WO/2016/198745, World Intellectual Property Organization (2016). [33] F. Oldewurtel A. Parisio C.N. Jones D. Gyalistras M. Gwerder V. Stauch B. Lehmann M. Morari Use of model predictive control and weather forecasts for energy efficient building climate control Energy Build. 45 2012 15 27 F. Oldewurtel, A. Parisio, C.N. Jones, D. Gyalistras, M. Gwerder, V. Stauch, B. Lehmann, M. Morari, Use of model predictive control and weather forecasts for energy efficient building climate control, Energy and Buildings 45 (2012) 15\u201327. [34] D. Gyalistras, A. Fischlin, M. Morari, C. Jones, F. Oldewurtel, A. Parisio, F. Ullmann, C. Sagerschnig, A. Gruner, Use of weather and occupancy forecasts for optimal building climate control, Tech. rep., Automatic Control Laboratory, ETH Zurich: Zug, Switzerland (2010). D. Gyalistras, A. Fischlin, M. Morari, C. Jones, F. Oldewurtel, A. Parisio, F. Ullmann, C. Sagerschnig, A. Gruner, Use of weather and occupancy forecasts for optimal building climate control, Tech. rep., Automatic Control Laboratory, ETH Zurich: Zug, Switzerland (2010). [35] M. Gwerder, D. Gyalistras, C. Sagerschnig, R. Smith, D. Sturzenegger, Final Report: Use of Weather and Occupancy Forecasts for Optimal Building Climate Control-Part II: Demonstration (OptiControl-II), Tech. rep., Automatic Control Laboratory, ETH Zurich: Zug, Switzerland (2013). M. Gwerder, D. Gyalistras, C. Sagerschnig, R. Smith, D. Sturzenegger, Final Report: Use of Weather and Occupancy Forecasts for Optimal Building Climate Control\u2013Part II: Demonstration (OptiControl-II), Tech. rep., Automatic Control Laboratory, ETH Zurich: Zug, Switzerland (2013). [36] F. Oldewurtel A. Ulbig A. Parisio G. Andersson M. Morari Reducing peak electricity demand in building climate control using real-time pricing and model predictive control 49th IEEE Conference on Decision and Control (CDC) 2010 IEEE 1927 1932 F. Oldewurtel, A. Ulbig, A. Parisio, G. Andersson, M. Morari, Reducing peak electricity demand in building climate control using real-time pricing and model predictive control, in: 49th IEEE conference on decision and control (CDC), IEEE, 2010, pp. 1927\u20131932. [37] D. Picard J. Drgoňa M. Kvasnica L. Helsen Impact of the controller model complexity on model predictive control performance for buildings Energy Build. 152 2017 739 751 D. Picard, J. Drgoňa, M. Kvasnica, L. Helsen, Impact of the controller model complexity on model predictive control performance for buildings, Energy and Buildings 152 (2017) 739\u2013751. [38] R. Carli G. Cavone S. Ben Othman M. Dotoli IoT based architecture for model predictive control of HVAC systems in smart buildings Sensors 20 3 2020 781 R. Carli, G. Cavone, S. Ben Othman, M. Dotoli, Iot based architecture for model predictive control of hvac systems in smart buildings, Sensors 20 (3) (2020) 781. [39] Ergonomics of the thermal environment \u2013 Analytical determination and interpretation of thermal comfort using calculation of the PMV and PPD indices and local thermal comfort criteria, Tech. Rep. 7730, International Organization for Standardization (2005). Ergonomics of the thermal environment \u2013 Analytical determination and interpretation of thermal comfort using calculation of the PMV and PPD indices and local thermal comfort criteria, Tech. Rep. 7730, International Organization for Standardization (2005). [40] X. Chen Q. Wang J. Srebric Model predictive control for indoor thermal comfort and energy optimization using occupant feedback Energy Build. 102 2015 357 369 X. Chen, Q. Wang, J. Srebric, Model predictive control for indoor thermal comfort and energy optimization using occupant feedback, Energy and Buildings 102 (2015) 357\u2013369. [41] X. Jin K. Baker S. Isley D. Christensen User-preference-driven model predictive control of residential building loads and battery storage for demand response, in 2017 American Control Conference (ACC) 2017 4147 4152 X. Jin, K. Baker, S. Isley, D. Christensen, User-preference-driven model predictive control of residential building loads and battery storage for demand response, in: 2017 American Control Conference (ACC), 2017, pp. 4147\u20134152. [42] C. Ptolemaeus (Ed.), System Design, Modeling, and Simulation using Ptolemy II, Ptolemy.org, 2014. URL: http://ptolemy.org/books/Systems. C. Ptolemaeus (Ed.), System Design, Modeling, and Simulation using Ptolemy II, Ptolemy.org, 2014. URL:http://ptolemy.org/books/Systems [43] R. Piché, S. Särkkä, J. Hartikainen, Recursive outlier-robust filtering and smoothing for nonlinear systems using the multivariate Student-t distribution, 2012 IEEE International Workshop on Machine Learning for Signal Processing (2012). R. Piché, S. Särkkä, J. Hartikainen, Recursive outlier-robust filtering and smoothing for nonlinear systems using the multivariate Student-t distribution, 2012 IEEE International Workshop on Machine Learning for Signal Processing (2012). [44] F. Gustafsson Adaptive filtering and change detection 2000 John Wiley & Sons F. Gustafsson, Adaptive filtering and change detection (2000). [45] J. Drgoňa Model predictive control with applications in building thermal comfort control (Ph.D. thesis) 2015 Slovak University of Technology in Bratislava J. Drgoňa, Model predictive control with applications in building thermal comfort control, Ph.D. thesis, SLOVAK UNIVERSITY OF TECHNOLOGY IN BRATISLAVA (2015). [46] Radiators and convectors \u2013 Technical specifications and requirements, Tech. Rep. EN 442\u20131:2014, EN (2014). Radiators and convectors \u2013 Technical specifications and requirements, Tech. Rep. EN 442-1:2014, EN (2014). [47] T. Parkinson Thermal pleasure and alliesthesia in the built environment 2016 University of Sidney (Ph.D. thesis) T. Parkinson, Thermal pleasure and alliesthesia in the built environment, Ph.D. thesis, University of Sidney (2016). [48] M. Bourdeau, X. qiang Zhai, E. Nefzaoui, X. Guo, P. Chatellier, Modeling and forecasting building energy consumption: A review of data-driven techniques, Sustain. Cities Soc. 48 (2019) 101533. M. Bourdeau, X. qiang Zhai, E. Nefzaoui, X. Guo, P. Chatellier, Modeling and forecasting building energy consumption: A review of data-driven techniques, Sustainable Cities and Society 48 (2019) 101533. [49] X. Ding W. Du A. Cerpa Octopus: Deep reinforcement learning for holistic smart building control ACM BuildSys 2019 326 335 X. Ding, W. Du, A. Cerpa, Octopus: Deep reinforcement learning for holistic smart building control, ACM BuildSys (2019). [50] B. Chen, Z. Cai, M. Bergés, Gnu-RL: A Precocial Reinforcement Learning Solution for Building HVAC Control Using a Differentiable MPC Policy, ACM BuildSys (2019) 316\u2013325. B. Chen, Z. Cai, M. Bergés, Gnu-RL: A Precocial Reinforcement Learning Solution for Building HVAC Control Using a Differentiable MPC Policy, in: Proceedings of the 6th ACM International Conference on Systems for Energy-Efficient Buildings, Cities, and Transportation, BuildSys \u201919, Association for Computing Machinery, New York, NY, USA, 2019, p. 316\u2013325. doi: 10.1145/3360322.3360849 [51] S. Brandi M.S. Piscitelli M. Martellacci A. Capozzoli Deep reinforcement learning to optimise indoor temperature control and heating energy consumption in buildings Energy Build. 224 2020 110225 S. Brandi, M.S. Piscitelli, M. Martellacci, A. Capozzoli, Deep reinforcement learning to optimise indoor temperature control and heating energy consumption in buildings, Energy and Buildings 224 (2020) 110225.",
    "scopus-id": "85140296306",
    "coredata": {
        "eid": "1-s2.0-S0378778822007198",
        "dc:description": "The capability to dynamically plan, predict, and control indoor conditioning allows to adapt to individual preferences of inhabitants and enables demand side management. While former mainly improves thermal comfort of inhabitants so does latter unlock ecological and financial opportunities mostly for energy utilities. Commonly, dynamic indoor conditioning is based on piece-wise constant indoor temperature constraints. This paper\u2019s contribution is the presentation of additional constraints: in particular ones expressed relative to the nominal behavior of a hydronic heating system. This allows to simultaneously harness the relevant process variables in particular during the pre-loading and post-loading phases of a load reduction. The findings are based on data sets acquired on 10 inhabited, residential buildings in Stockholm over a whole year. One of the findings is that building models need to be adaptable if predictive control is applied in practice. This adaptability is assured by a novel concept, i.e. a so called model manager on which the control is relying for the selection of the most accurate model. Centralized optimal control of buildings connected to a district heating network is challenging in practice due to a high computational load. In order to reduce it, the herein presented method elaborates plans only every hour instead of at every control step for optimal control. Since these plans cannot be optimal due to the lack of regular update a hitherto unknown cascaded control logic has been developed that corrects planning errors and other disturbances. Capabilities are demonstrated and compared to conventional controllers in dynamic simulations of a multi-zoned building. The herein presented method is to our knowledge the first to provide all flexibility desired by energy utilities and inhabitants alike through harnessing the consequences of transitions.",
        "openArchiveArticle": "false",
        "prism:coverDate": "2022-12-15",
        "openaccessUserLicense": null,
        "prism:aggregationType": "Journal",
        "prism:url": "https://api.elsevier.com/content/article/pii/S0378778822007198",
        "dc:creator": [
            {
                "@_fa": "true",
                "$": "Hamp, Quirin"
            },
            {
                "@_fa": "true",
                "$": "Levihn, Fabian"
            }
        ],
        "link": [
            {
                "@_fa": "true",
                "@rel": "self",
                "@href": "https://api.elsevier.com/content/article/pii/S0378778822007198"
            },
            {
                "@_fa": "true",
                "@rel": "scidir",
                "@href": "https://www.sciencedirect.com/science/article/pii/S0378778822007198"
            }
        ],
        "dc:format": "application/json",
        "openaccessType": null,
        "pii": "S0378-7788(22)00719-8",
        "prism:volume": "277",
        "articleNumber": "112548",
        "prism:publisher": "Elsevier B.V.",
        "dc:title": "Model predictive control for dynamic indoor conditioning in practice",
        "prism:copyright": "© 2022 Elsevier B.V. All rights reserved.",
        "openaccess": "0",
        "prism:issn": "03787788",
        "dcterms:subject": [
            {
                "@_fa": "true",
                "$": "Model predictive control"
            },
            {
                "@_fa": "true",
                "$": "Demand side management"
            },
            {
                "@_fa": "true",
                "$": "Load reduction"
            },
            {
                "@_fa": "true",
                "$": "Configurability"
            },
            {
                "@_fa": "true",
                "$": "Building heating"
            },
            {
                "@_fa": "true",
                "$": "Thermal storage"
            },
            {
                "@_fa": "true",
                "$": "Thermal comfort"
            },
            {
                "@_fa": "true",
                "$": "Demand forecasting"
            },
            {
                "@_fa": "true",
                "$": "State space"
            },
            {
                "@_fa": "true",
                "$": "District heating system"
            },
            {
                "@_fa": "true",
                "$": "Modeling"
            },
            {
                "@_fa": "true",
                "$": "Energy efficiency"
            },
            {
                "@_fa": "true",
                "$": "Building simulation"
            }
        ],
        "openaccessArticle": "false",
        "prism:publicationName": "Energy and Buildings",
        "openaccessSponsorType": null,
        "prism:pageRange": "112548",
        "pubType": "fla",
        "prism:coverDisplayDate": "15 December 2022",
        "prism:doi": "10.1016/j.enbuild.2022.112548",
        "prism:startingPage": "112548",
        "dc:identifier": "doi:10.1016/j.enbuild.2022.112548",
        "openaccessSponsorName": null
    },
    "objects": {"object": [
        {
            "@category": "standard",
            "@height": "648",
            "@width": "517",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr10.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "79877",
            "@ref": "gr10",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "254",
            "@width": "385",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr3.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "55539",
            "@ref": "gr3",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "232",
            "@width": "655",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr8.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "32851",
            "@ref": "gr8",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "398",
            "@width": "669",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr9.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "73571",
            "@ref": "gr9",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "503",
            "@width": "774",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr11.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "63528",
            "@ref": "gr11",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "243",
            "@width": "661",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr2.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "25555",
            "@ref": "gr2",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "323",
            "@width": "663",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr4.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "52467",
            "@ref": "gr4",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "437",
            "@width": "531",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr5.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "70087",
            "@ref": "gr5",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "384",
            "@width": "663",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr6.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "84753",
            "@ref": "gr6",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "357",
            "@width": "587",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr7.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "32053",
            "@ref": "gr7",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@height": "419",
            "@width": "597",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr1.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-DOWNSAMPLED",
            "@size": "64164",
            "@ref": "gr1",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "thumbnail",
            "@height": "163",
            "@width": "130",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr10.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "9749",
            "@ref": "gr10",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "145",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr3.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "10652",
            "@ref": "gr3",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "77",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr8.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "5290",
            "@ref": "gr8",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "130",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr9.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "8043",
            "@ref": "gr9",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "142",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr11.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "8172",
            "@ref": "gr11",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "80",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr2.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "3926",
            "@ref": "gr2",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "107",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr4.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "7805",
            "@ref": "gr4",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "164",
            "@width": "199",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr5.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "12451",
            "@ref": "gr5",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "127",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr6.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "10143",
            "@ref": "gr6",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "133",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr7.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "6319",
            "@ref": "gr7",
            "@mimetype": "image/gif"
        },
        {
            "@category": "thumbnail",
            "@height": "154",
            "@width": "219",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr1.sml?httpAccept=%2A%2F%2A",
            "@multimediatype": "GIF image file",
            "@type": "IMAGE-THUMBNAIL",
            "@size": "10025",
            "@ref": "gr1",
            "@mimetype": "image/gif"
        },
        {
            "@category": "high",
            "@height": "2869",
            "@width": "2288",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr10_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "629742",
            "@ref": "gr10",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1128",
            "@width": "1707",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr3_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "330554",
            "@ref": "gr3",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1026",
            "@width": "2901",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr8_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "211186",
            "@ref": "gr8",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1762",
            "@width": "2963",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr9_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "464468",
            "@ref": "gr9",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "2226",
            "@width": "3427",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr11_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "475411",
            "@ref": "gr11",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1076",
            "@width": "2929",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr2_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "171052",
            "@ref": "gr2",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1431",
            "@width": "2937",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr4_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "394337",
            "@ref": "gr4",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1935",
            "@width": "2350",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr5_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "728638",
            "@ref": "gr5",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1702",
            "@width": "2937",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr6_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "948802",
            "@ref": "gr6",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1582",
            "@width": "2601",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr7_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "230192",
            "@ref": "gr7",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "high",
            "@height": "1858",
            "@width": "2645",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-gr1_lrg.jpg?httpAccept=%2A%2F%2A",
            "@multimediatype": "JPEG image file",
            "@type": "IMAGE-HIGH-RES",
            "@size": "472657",
            "@ref": "gr1",
            "@mimetype": "image/jpeg"
        },
        {
            "@category": "standard",
            "@_fa": "true",
            "$": "https://api.elsevier.com/content/object/eid/1-s2.0-S0378778822007198-am.pdf?httpAccept=%2A%2F%2A",
            "@multimediatype": "Acrobat PDF file",
            "@type": "AAM-PDF",
            "@size": "2016831",
            "@ref": "am",
            "@mimetype": "application/pdf"
        }
    ]},
    "link": {
        "@rel": "abstract",
        "@href": "https://api.elsevier.com/content/abstract/scopus_id/85140296306"
    }
}}